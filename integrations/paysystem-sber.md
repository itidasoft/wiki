---
title: Интеграция с платежной системой Сбербанка
description: Руководство по подключению платежной системы Сбербанка
published: true
date: 2024-12-12T07:40:01.896Z
tags: эквайринг, сбер, сбербанк, платежная система
editor: markdown
dateCreated: 2023-09-13T09:34:01.955Z
---

# Условные обозначения
`МРП` - Модуль Регистрации Продаж. 
`МРП1` - Встроенные в Айтиду модуль регистрации продаж. Вызывается только внутри основного приложения Айтида
`МРП2/РМК` - Отдельный модуль регистрации продаж с современным и удобным интерфейсом, который может быть установлен и запущен на отдельном рабочем месте кассира как самостоятельное приложение и синхронизировать данные с основным приложением Айтида.

# Введение
Этот вариант интеграции предусматривает работу с платежной системой Сбербанка без использования сторонних драйверов. В интеграции задействованы компоненты Сбербанка, которые поставляются сотрудниками банка бесплатно и устанавливаются банковским техническим специалистом в момент подключения эквайрингового терминала на торговой точке.

# Установка и настройка платежной системы

1.  Скопировать на жесткий диск следующие файлы:

    **SB_KERNEL.DLL, GATE.DLL, SBRF.DLL, SBRFCOM.dll, LOADPARM.EXE, RRDK.R, R003.R, PARAMS.TLV**

2.  Зарегистрировать библиотеку **SBRF.dll** с помощью команды `regsvr32 SBRF.dll`.
3.  Зарегистрировать библиотеку **SBRFCOM.dll** с помощью команды `regsvr32 SBRFCOM.dll`.
4.  Подключить ПИН-клавиатуру к порту СОМ1 или к USB-порту.
5.  Выполнить загрузку настроечных параметров библиотеки. Для этого запустить программу **LOADPARM.EXE**, зайти в меню «Служебные операции \\ Настройки \\ Техобслуживание \\ Пароль 878787 \\ Загрузка параметров», выбрать файл **PARAMS.TLV** и дождаться окончания загрузки.
6.  Настроить платежную систему на формирование **одного банковского слипа**. Передать эту информацию сотруднику Сбербанка для внесения изменений по количеству слипов в конфигурацию на сервере (в противном случае информация перезапишется при следующем обновлении). Так же можно сперва попросить сотрудника Сбербанка внести изменения в конфигурацию на сервере с установкой количества слипов равным одному, а затем произвести загрузку параметров для принятия изменений.

# Подключение платежной системы к МРП2 / РМК

Модуль регистрации продаж версии 2 для работы с платежными системами поддерживает отдельный вид оборудования "Платежные системы".
Для настройки интеграции необходимо создать карточку оборудования по следующему шаблону:
![sber_paysystem_eqpay.png](/images/integrations/paysystem-sber/sber_paysystem_eqpay.png){.align-center}
**Наименоване:** Указать произвольное наименование оборудования
**Тип оборудования:** Выбрать "Платежная система"
**Профиль:** Выбрать профиль под названием "Платежная система СБЕРБАНК"
**Краткое имя:** указать короткое и уникальное обозначение устройства, которое будет отображаться в форме распределения оплат по платежным системам в режиме регистрации продаж.
**Устройство:** указать номер отдела из платежной системы Сбербанка.
**Вид оплаты:** Выбрать требуемый вид оплаты для платежной системы. Зачастую это "Безналичные".
**Копий слипа:** указать количество копий слипа для печати.
В поле **Номер ФР** можно выбрать ККТ, на которой будет распечатан слип платежной системы, если такой подразумевается драйвером.

После заполнения параметров необходимо сохранить карточку оборудования, нажав кнопку "Записать" и добавить её в список оборудования для рабочего места в схеме РМК.
![sber_paysystem_rmkscheme.png](/images/integrations/paysystem-sber/sber_paysystem_rmkscheme.png){.align-center}

После произведенных настроек оборудования и подключения платежной системы к рабочему месту в режиме регистрации продаж, при наличии в чеке оплаты с видом "Безналичные", при закрытии чека оплата будет происходить через подключенную к рабочему месту платежную систему, а следом распечатаны слипы платежной системы и пробит кассовый чек.

> **Внимание!** Во избежание ситуаций с двойной авторизацией и оплатой по платежной системе при пробитии чеков для оборудования с типом **"Фискальный регистратор"** необходимо использовать профили ФР без указания в их названии *"с платежной системой"*. Например:
	- Библиотека ФР. Профиль ФР Атол (ФН, ФФД 1.05, ДТО 10)
	- Библиотека ФР. Профиль ФР Атол (ФН, ФФД 1.2, ДТО 10)
	- Библиотека ФР. Профиль ФР Меркурий (Инкотекс) (ФН, ФФД 1.05, INECRMAN)
	- Библиотека ФР. Профиль ФР Меркурий (Инкотекс) (ФН, ФФД 1.2, INECRMAN)
	- Библиотека ФР. Профиль ФР Штрих (ФН, ФФД 1.05, ДККТ 4.Х-5.Х)
 	- Библиотека ФР. Профиль ФР Штрих (ФН, ФФД 1.2, ДККТ 5.Х)
{.is-warning}


# Подключение платежной системы к МРП1
Модуль Регистрации Продаж версии 1 не поддерживает отдельного типа оборудования такого как "Платежная система", поэтому подключение платежных систем реализуется путём встраивания модулей для работы с платежными системами в профиль для работы с фискальным регистратором.
Все профили фискальных регистраторов, поддерживающие работу с платежными системами имеют в своем названии дополнительное обозначение: "...Платежная система СБЕРБАНК".
Список актуальных профилей оборудования со встроенной работой с платежной системой Сбербанка:

- Профиль ФР Атол v.5 (ФН, ФФД 1.05, ДТО 10) с платежной системой СБЕРБАНК
- Библиотека ФР. Профиль ФР Атол (ФН, ФФД 1.05, ДТО 10, Платежная система СБЕРБАНК)
- Библиотека ФР. Профиль ФР Атол (ФН, ФФД 1.2, ДТО 10, Платежная система СБЕРБАНК)
- Библиотека ФР. Профиль ФР Меркурий (Инкотекс) (ФН, ФФД 1.05, INECRMAN, Платежная система СБЕРБАНК)
- Библиотека ФР. Профиль ФР Меркурий (Инкотекс) (ФН, ФФД 1.2, INECRMAN, Платежная система СБЕРБАНК)
- Библиотека ФР. Профиль ФР Штрих (ФН, ФФД 1.05, ДККТ 4.Х-5.Х, Платежная система СБЕРБАНК)
- Библиотека ФР. Профиль ФР Штрих (ФН, ФФД 1.2, ДККТ 5.Х, Платежная система СБЕРБАНК)

Для настройки интеграции необходимо создать карточку торгового оборудования по следующему шаблону:
![sber_paysystem_eqfr1.png](/images/integrations/paysystem-sber/sber_paysystem_eqfr1.png){.align-center}
**Наименование:** Указать любое наименование оборудования
**Тип оборудования:** Выбрать "Фискальный регистратор"
**Профиль:** Выбрать профиль фискального регистратора, содержащего "...Платежная система СБЕРБАНК" в наименовании.
По кнопке Настройка драйвера оборудования настроить связь с фискальным регистратором.

На вкладке **"Печать чека / ОФД / ПС"** указать следующие параметры:
![sber_paysystem_eqfr2.png](/images/integrations/paysystem-sber/sber_paysystem_eqfr2.png){.align-center}

**Использовать ФР для печати чеков платежной системы:** Установить или снять флаг, в зависимости от требований к печати слипов. Установка флага не является обязательнои и используется для случаев, когда необходимо все слипы печатать на определенной ККТ, когда к рабочему месту подключено более одного фискального регистратора.
**Номер платежной системы в драйвере:** необходимо указать номер отдела в платежной системе Сбербанка, уменьшенного на 1. Определение устройства осуществляется по номерам отделов. Для первого отдела указать значение 0, для второго - 1, и так далее.

После заполнения параметров необходимо сохранить карточку оборудования и добавить её в список подключенного оборудования в локальном оборудовании. Подробнее о подключении оборудования к рабочему месту по ссылке: [Локальное оборудование рабочего места](/docs/quick-start/local-devices#локальное-оборудование-рабочего-места).