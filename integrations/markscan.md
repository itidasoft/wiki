---
title: Айтида и АТОЛ Mark.Scan
description: Руководство по интеграции с программным обеспечением для ТСД АТОЛ Mark.Scan
published: true
date: 2022-12-21T09:44:05.657Z
tags: тсд, mark.scan, атол
editor: markdown
dateCreated: 2022-12-21T09:44:02.943Z
---

# Введение

Данное руководство содержит описание процесса интеграции с терминалами сбора данных под управлением программного обеспечения АТОЛ Mark.Scan.

В рамках интеграции с ПО Mark.Scan поддерживаются следующие основные бизнес-процессы:

-   Учет движения товара: приемка, отгрузка, списание, перемещение и возврат.
-   Контроль за ценниками: проверка соответствия с данными товароучетной системы.
-   Сбор штрихкодов, кодов маркировки.
-   Инвентаризация и контроль остатков.
-   Идентификация товара: получение информации о номенклатуре.
-   Создание складских документов прямо на ТСД.
-   Работа по документам из Айтида.
-   Работа с маркированными товарами, ЕГАИС и МОТП.
-   Обмен данными с Айтида без проводов (по WiFi).
-   Работа с заданиями (документами) в двух режимах: режим добавления в задание и режим подтверждения задания. Данные режимы применяются при работе с маркированными товарами.

>   В рамках данного руководства будет рассмотрен процесс интеграции с ТСД напрямую, без участия сервера Mark.Scan. Интеграция и описание работы через сервер будет добавлена в будущих версиях.
{.is-info}


Ниже представлен перечень документов, которые выгружаются в ТСД в рамках данной интеграции:

| **Имя документа Айтида** | **Имя документа ТСД** |
|--------------------------|-----------------------|
| Приходная накладная      | Приёмка               |
| Инвентаризация ТМЦ       | Инвентаризация        |
| Инвентаризация ЕГАИС     | Инвентаризация        |
| Возврат поставщику       | Возврат               |
| Внутреннее перемещение   | Перемещение           |
| Расходная накладная      | Отгрузка              |
| Переоценка ТМЦ           | Переоценка            |

>   Поддерживается возможность загрузки документа «Сбор штрихкодов» из ТСД в любой документ в Айтиде.
{.is-info}


# Настройка ТСД

ТСД необходимо подключить посредством WiFi к той же локальной сети, что и ПК, с которого производится обмен с устройством. Допускается подключение и из другой сети при наличии соответствующих настроек проброса портов в маршрутизаторе.

На ТСД должно быть установлено ПО АТОЛ Mark.Scan и активирована лицензия.

В настройках Mark.Scan должны быть установлены следующие параметры:

**Формат выгрузки штрихкодов:** base64-строка

![](/images/integrations/markscan/261901303f932ba745207e94335d841a.jpeg)

**Файловый обмен:** Нет

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/df199bf369e993e060e8e5e347464f45.jpeg)

Так же должна быть запущена служба Mark.Scan API, которая запускается автоматически при запуске приложения.

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/c986b424b1aa22397cf9ff9b2127c456.jpeg)

![](/images/integrations/markscan/68fcf76d4a3e6cf7771e5702569619b9.jpeg) ![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/d2691145e82511f7bba398f9a8bbeab4.jpeg)

В разделе «Диагностика» отображается текущий адрес API ТСД, по которому будет работать интеграция с Айтида.

# Настройка констант

При выгрузке в ТСД документов из Айтида, в которых имеется штатная колонка «Реальное количество» в спецификации документа ( Инвентаризация ТМЦ, Инвентаризация ЕГАИС), применяется следующий алгоритм выгрузки реального количества:

Если введено реальное количество, то количество товара в строке уменьшается на количество, введенное в поле «Реальное количество», и полученное количество выгружается в задании на ТСД. Данный алгоритм удобно использовать при проведении инвентаризации, когда все данные загружены в документ и требуется произвести дополнительное сканирование на ТСД. При этом на ТСД будет выгружено в инвентаризацию только недостающее до общего учетного значения количество.

Если данный алгоритм необходимо отключить, то нужно создать константу в справочнике констант (Сервис – Настройка системы – Настройка констант системы) с названием **\_MARKSCAN_НЕВЫГРУЖАТЬРЕАЛЬНОЕКОЛИЧЕСТВО** и значением логического типа «Истина».

Действие константы не распространяется на документ «Приходная накладная».

При отсутствии константы или наличии её со значением логического типа «Ложь» описанный выше алгоритм будет включен.

После изменения значения константы требуется перезапустить программу Айтида.

# Настройка интеграции

На данном этапе предполагается, что ТСД предварительно настроен, подключен к локальной сети посредством WiFi и к нему имеется прямой доступ по IP адресу и порту, которые указаны в разделе «Диагностика» приложения Mark.Scan.

>   Для обмена с ТСД под управлением ATOL Mark.Scan необходимо обновить Айтиду до версии не ниже, чем 4.4.6. Так же должна использоваться конфигурация, поддерживающая работу с ТСД. Подробную информацию по конфигурациям с поддержкой работы с ТСД можно посмотреть по ссылке: [**https://itida.ru/products/ajtida-retail-otlichiya-konfiguratsij**](https://itida.ru/products/ajtida-retail-otlichiya-konfiguratsij)
{.is-warning}


После обновления Айтиды потребуется загрузить актуальные профили обмена с оборудованием с сайта и загрузить в справочник профилей оборудования (Параметры – Справочник профилей оборудования), профиль под названием «Профиль обмена с ТСД АТОЛ Mark.Scan».

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/fcb21e700f1a6194b4cf574213710c05.png)

После загрузки профиля необходимо перейти в справочник торгового оборудования и создать карточку оборудования по следующему шаблону:

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/5b64796af3fd911f0f8512321d5e8168.png)

**Наименование:** указать произвольное наименование оборудования

**Тип оборудования:** Терминал сбора данных

**Профиль:** выбрать загруженный профиль для Mark.Scan

**Устройство:** выбрать «АТОЛ MARK.SCAN»

**Строка соединения:** указать адрес API ТСД, который отображается на терминале в разделе «Диагностика».

**Склад нахождения:** указать требуемый склад для работы

**Юридическое лицо:** указать требуемую организацию для работы

После указания всех перечисленных настроек требуется записать карточку торгового оборудования и для проверки правильности указания IP адреса и порта ТСД нажать кнопку **«Настройка драйвера оборудования».**

Если все настроено верно, то должно выйти окно с информацией о ТСД, лицензиях и хранящихся в нем документах.

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/f94f3faacff1a77c98e3859de5215632.png)

>   Если такое окно с информацией не появилось, то проверьте корректность указания адреса ТСД и факт подключения ТСД к WiFi сети.
{.is-warning}


Для активации работы с ТСД в программе нужно включить работу с ТСД в локальном оборудовании (Параметры – Локальное оборудование)

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/0b2f64091694735d86b81e1686d9fc0e.png)

После активации данной настройки в документах и журналах документов в подменю действй кнопки обмена с оборудованием появятся соответствующие пункты для обмена с ТСД.

![Изображение выглядит как текст Автоматически созданное описание](/images/integrations/markscan/6968ef53befd2549be921114f9ec75eb.png)

На этом настройка интеграции с ТСД под управлением программного обеспечения АТОЛ Mark.Scan завершена. Дальнейший обмен с ТСД осуществляется согласно руководству пользователя.
