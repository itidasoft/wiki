---
title: Настройка торгового оборудования
description: Руководство админстратора
published: true
date: 2022-08-10T14:53:44.728Z
tags: сканер шк, оборудование, весы, прайс-чекер, тсд, ккм
editor: markdown
dateCreated: 2022-08-10T14:53:44.728Z
---

# Подключение торгового оборудования

Система Айтида содержит возможности для обеспечения интеграции с торговым оборудованием. Под интеграцией подразумевается организация двустороннего обмена данными между системой Айтида и внешним торговым оборудованием. Выгрузка данных из системы Айтида во внешнее оборудование производится для обеспечения автономной работы данного оборудования. Обратная загрузка данных из оборудования в систему производится для формирования документов отражающих реальное движение ТМЦ и денежных средств, зафиксированное этим оборудованием.

> **Внимание!** В текущих версиях **ПП Айтида** имеется возможность производить обмен по **ODBC**. Однако, при этом шифрования паролей пользователей **«Frontol»** не производится. Необходимо производить выгрузку без регистрационный данных пользователей. В этом случае вход в программу будет возможен.
{.is-warning}


Поддерживаются следующие виды оборудования:

1.  Кассовые модули на основе фронт-систем или отдельно стоящих касс.
2.  Фискальные регистраторы и Принтеры чеков, работающие с формой регистрации продаж системы Айтида.
3.  Весы без печати этикеток, работающие с системой Айтида.
4.  Весы с печатью этикеток.
5.  Терминалы сбора данных.
6.  Прайс-чекеры.

> **Примечание!** *Информацию о поддержке обмена с другими видами оборудования, следует уточнять у специалистов ПП Айтида.*
{.is-info}


Для каждого типа оборудования могут быть доступны свои профили обмена. **Профиль оборудования** – это набор пользовательских обработок, позволяющих самостоятельно настроить формат и правила обмена данными с оборудованием. Профиль может быть настроен практически для любого оборудования.

> *Лицензионный ключ на ДТО АТОЛ необходимо приобретать отдельно, так как в лицензию Айтида он не включен.*
{.is-info}


# Использование Профилей обмена данными

Основным инструментов для осуществления обмена данными в ПП Айтида служит **«Форма обмена данными с оборудованием»**.

**Меню Сервис - Обмен данными с оборудованием**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/1a998419070ac58ba3b578058d91e721.png)

Есть два варианта данной формы.

1.  **Форма обмена данными с оборудованием 2.1** - работает по предопределенному алгоритму, который не может быть изменен партнером. Используется для обеспечения обратной совместимости с более ранними версиями системы.
2.  **Форма обмена данными с оборудованием 2.2.** - позволяет задействовать механизм «Профилей оборудования».

**Профиль оборудования** – это программа, реализующая алгоритм обмена данными с оборудованием, которая может быть изменена партнером для внесения в алгоритм обмена изменений, отражающих особенности взаимодействия с конкретным оборудованием клиента. Для каждого конкретного экземпляра оборудования может быть указан свой профиль обмена, что позволяет обеспечить единообразную обработку обмена данными с самым разным оборудованием.

Профили могут быть настроены на определенный тип оборудования. При взаимодействии с программой Айтида каждое действие алгоритма обмена данными описывается в определенном событии (подробнее см. [Техническое описание](https://itida.ru/download/docs/tech_part2.pdf), раздел профили оборудования). Алгоритм профиля включает в себя совокупность обработки событий, понятные для драйвера устройства, и допускают возможность редактирования алгоритма.

> **Внимание!** *Для обмена данными с оборудованием, в частности ККМ, которое использует профили, необходимо использовать Форму обмена 2.2.*
{.is-warning}


# Подключение профилей оборудования

> **Примечание!** *Актуальные профили обмена данными с оборудованием  можно скачать по* [*ссылке*](https://itida.ru/obnovleniya-i-profili/profili-oborudovaniya-algoritmy-parametry-i-funktsii)*. Справочник профилей оборудования доступен с NFR лицензией или сублицензией.*
{.is-info}


1.  Для загрузки профилей оборудования в БД Айтида, необходимо зайти:

**Меню Параметры – Справочник профилей оборудования – кнопка «Обмен»**

![](/images/admin-guide/equipment/b2c072d3823f7265f676dadd123911b6.png)

2.  Указать сохраненный файл и нажать кнопку **«Загрузить в базу»**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/1a05855f9b2cc49eb798528445f43e9f.png)

3.  В появившемся окне отметить флагом профили оборудования, которые необходимо загрузить в БД или нажать кнопку **«Выбрать все».**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/544c9b949ac18352ecdf5a505a911ad1.png)

4.  Для окончательной загрузки в БД профилей оборудования нажать кнопку **«Загрузить в базу».**
5.  Для использования, загруженного ранее профиля обмена, торговым оборудованием, необходимо выбрать его в карточке торгового оборудования в выпадающем списке **«Профиль»**.

**Меню Параметры – Торговое оборудование – выбрать профиль обмена**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/338f892504866b4edf1f91c0478bf383.png)

6.  Чтобы обмен данными с оборудованием происходил по загруженному и выбранному профилю оборудования обязательно отключение формы обмена **релиза 2,1**. При запуске формы **«Обмен данными с оборудованием»** будет использоваться форма обмена релиза 2,2.

**Меню Параметры – Параметры пользователя – снять флаг «Использовать форму обмена 2,1»**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/746514992a6b2f199af73e7b3a907350.png)

7.  Для обмена с торговым оборудованием данными необходимо запустить Форму **«Обмена данными с оборудованием»**.

**Меню Сервис – Обмен данными с оборудованием**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/92ad533f316a3a0f1da192aefdb1f8a9.png)

# Торговое оборудование

Изначально справочник пуст.

**Меню Параметры – Торговое оборудование**

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/equipment/8ee89b63da2e431be79527455e7d4885.png)

> **Внимание!** Если какие-либо весы выделены галочкой в «Справочнике торгового оборудования», то опция «Список товаров в весах» выпадающего списка, при кнопке **«Печать журнала документов»**  позволяет сформировать для печати список товаров, относящихся именно к данным весам **(доступно только в** конфигурациях **«Pos версия», «EasyBox», «Минимаркет» и «Супермаркет»).**
{.is-info}


> **Внимание!** Работа с весами с печатью этикеток **доступно только в** конфигурациях **«Pos версия», «EasyBox», «Минимаркет» и «Супермаркет».**
{.is-info}


# Настройка локального оборудования

При вызове пункта **«Локальное оборудование»** открывается окно **«Локальный профайл»**. В этом окне содержится набор опций, необходимых для задания параметров подключенного оборудования. В форме **«Локальный профиль»**, можно указать используемое на рабочем месте оборудование. При этом введенные данные не будут сохранены в базе данных, а будут сохранены в рабочем каталоге системы на рабочем месте. У пользователя должно быть право на запись в рабочий каталог системы Айтида.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/a5a608fb0524aa1a87fae5d2ae00a99e.png)

**Использовать указанный сервер лицензий —** при установке признака и указании адреса сервера, в момент запуска системы будет осуществлен поиск рабочей лицензии: в локальном реестре Windows, на указанном в этом параметре сервере и на сервере, указанном в параметрах системы. Данная настройка позволяет установить несколько серверов с различными лицензиями в одной локальной сети. Адрес задается в формате IP_адрес:НомерПорта. Если номер порта не указан, то считается что используется 98-й порт.

> **Примечание!** *Адрес задается в формате* **IP_адрес:НомерПорта***. Если номер порта не указан, то считается что используется* **98***-й порт.*
{.is-info}


**Использовать сканер штриховых кодов (COM) —** установка признака позволяет задать параметры использования сканера штриховых кодов, работающего через COM порт. Настройка порта, четности, стоп-битов, размера байта (7 или 8), скорости передачи данных и контроля потока, задают системные параметры протокола обмена с COM портом. Указание символов разделителей является обязательным, т.к. по факту чтения этих символов из COM порта система определяет момент завершения чтения штрихового кода. Если используется несколько символов разделителей подряд, то их коды должны быть указаны через запятую. Сами символы разделители в прочитанный штриховой код не входят.

**Использовать клавиатурный сканер штриховых кодов —** установка признака позволяет указать параметры использования клавиатурного сканера штриховых кодов.

В связи с тем, что многие модели сканеров при «вставке» прочитанных символов в буфер клавиатуры не указывают, что это символы, прочитанные не с клавиатуры, то единственным способом определить, что произошло чтение кода сканером, остается частота поступления символов в буфер клавиатуры. У сканера и других устройств она значительно выше, чем при вводе с клавиатуры.

В тоже время, значительно надежнее, если сканер настроен на генерацию префикса перед передачей прочитанных символов. Это позволяет системе не влиять на поток входящих символов, до тех пор, пока не встретится указанный префикс. В противном случае, система вынуждена считывать весь входящий поток, и по истечению времени возвращать его обратно в систему. Это может вызывать определенные задержки, особенно при быстром вводе с клавиатуры.

Для клавиатурного сканера обязательно указание суффикса штрихового кода. Без его указания система не сможет определить, когда закончился штриховой код, и всегда по истечении указанного интервала будет возвращать символы в клавиатурный буфер.

**Записать параметры в драйвер —** при нажатии данной кнопки, указанные параметры будут переданы драйверу штриховых кодов. Для проверки сканера необходимо прочитать им любой штриховой код. Если параметры установлены правильно, то прочтенный код отобразиться в окне сообщения.

**Использовать профиль —** данное поле позволяет указать профиль оборудования, которому будет передаваться управление, каждый раз при чтении сканером штрихового кода. Использование профиля позволяет осуществить специальную обработку прочитанных данных, до передачи их системе. Например, при использовании клавиатурные устройства чтения магнитных карт, профиль может убирать специальные символы из прочитанного кода, генерируемые такими устройствами.

**Использовать ТСД —** установка признака и выбор карточки оборудования позволяет определить ТСД, который используется по умолчанию в системе. Если на рабочем месте используется ТСД, то указание значения в этом поле обязательно. В противном случае использование ТСД будет невозможно.

**Оборудование —** позволяет определить список локального оборудования, подключенного к рабочей станции. В качестве оборудования могут быть указаны фискальные регистраторы, принтеры чеков и весы без печати этикеток.

# Сканер штрих-кодов

Программные продукты серии **«Айтида Retail»** и **«Айтида HoReCa»** поддерживают работу со всеми сканерами ШК, которые поставляет АТОЛ. Перед настройкой сканера ШК необходимо подключить сканер к компьютеру и через параметры пользователя открыть окно **«Локальный профайл»**.

**Меню Параметры – параметры пользователя – Локальное оборудование**

Для подключения клавиатурного сканера необходимо установить признак **«Использовать клавиатурный сканер штриховых кодов»**. Предварительно, сканер необходимо запрограммировать на передачу префикса (символ разделитель, добавляемый сканером перед первым символом штрихового кода) с кодом **0x7A** и суффикса (символ разделитель, добавляемый сканером после последнего символа штрихового кода) с кодом **13** (**0x0D**). Процедура программирования сканера зависит от его модели, но чаще всего, это чтение последовательности штриховых кодов указанной в документации. После завершения программирования сканера, выбранные префикс и суффикс необходимо указать в соответствующих полях. **«Записать параметры в драйвер»** и прочитать сканером штрих любой штриховой код.

> **Внимание!** При использовании 2D сканера для чтения кодов акцизных марок задание префикса и суффикса является обязательным. Так же, в этом случае необходимо увеличить **Время ожидания** до 1000 мс.
{.is-warning}


| При установке признака «**Использовать клавиатурный сканер штриховых кодов**» пункты настройки параметров клавиатурного сканера штриховых кодов и его драйвера станут доступными для редактирования.                                                                                                | ![2013-04-09_090906.png](/images/admin-guide/equipment/5dd618b8eba05fde64aa529d361873f1.png)                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![2013-04-09_091024.png](/images/admin-guide/equipment/42c86b098b8a5510211a41d5293cb11c.png)                                                                                                                                                                                                                                | Кнопка «Определение префикса и суффикса» откроет окно регистрации, в котором необходимо считать сканером какой-либо штриховой код. После считывания ШК появится окно о времени чтения ШК, нажать кнопку ОК.                                            |
| После нажатия этой кнопки открывается окно регистрации. В течение 10 секунд нужно прочитать сканером какой-либо штриховой код. Затем необходимо проверить, что префикс и суффикс определились правильно и нажать кнопку **«Записать параметры в драйвер»** для сохранения этих значений в системе.  | ![2013-04-09_091635.png](/images/admin-guide/equipment/360263b3bb4241be4aa66f7a968e97b4.png)                                                                                                                                                                                   |

> Значения префикса и суффикса будут записаны в соответствующие поля. Для сохранения этих значений в системе следует нажать кнопку «Записать параметры в драйвер». Для сохранения настроек окна локального профайла необходимо нажать кнопку «Записать».
{.is-warning}


## Проверка связи с ДТО

Для проверки работы сканера штрих-кода необходимо запустить **«Драйвер устройств ввода»** АТОЛ-технологии.

| ![2013-04-08_153753.png](/images/admin-guide/equipment/799af2de12c42e6657fdc7d9ca4d477a.png)                                                                                                                        | В открывшемся окне необходимо нажать кнопку «Настройка свойств».                                                                                                                                                                                                                                                                    |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| В открывшемся окне нажмите кнопку «Поиск оборудования».                                                                                                                                     | ![2013-04-08_153943.png](/images/admin-guide/equipment/94d3da2e2e48e236d3ba2b9febf525fa.png)                                                                                                                                                                                                                                                                |
| ![2013-04-08_154349.png](/images/admin-guide/equipment/95dee31261bf86dd02ad967813740f35.png)                                                                                                                        | Считать сканером штрих-код какого-нибудь товара. Штриховой код автоматически отобразится в окне «Поиск оборудования».                                                                                                                                                                                                               |
| Отобразится перечень параметров соединения со сканером ШК. Порт компьютера, к которому подключен сканер ШК. № считанного ШК сканером. Символы разделители, запрограммированные в сканер ШК. | ![2013-04-08_162701.png](/images/admin-guide/equipment/28e83d94568cffcd3f93b8d26c3b1640.png)                                                                                                                                                                                                                                                                |

> Необходимо запомнить номер порта и символы-разделители штрих-кодов. Эти данные необходимо указать в системе Айтида. При использовании USB-сканера штрих-кодов с эмуляцией COM-порта, необходимо указывать настройки эмулятора COM-порта, а если сканер клавиатурный, то настроить префикс – **F11** (\#122), суффикс – Enter **CR** (\#13). 
{.is-warning}

# ККМ

В программных продуктах серии Айтида реализован обмен данными с кассами **«Frontol»**, **«Штрих-М»** , **«ДримКас»** **и другими**. Для всех вариантов используются общие параметры настройки.

Синхронизация справочников товаров между ПП Айтида и кассовой программой **«Frontol»** производится по кодам товаров. В ПП Айтида коды товаров (поле **«Код в главной базе»**, в карточке товара) является строкой с максимальной длиной 10 символов. Во **«Frontol»** код товара – число целое. Поэтому использование кодов с лидирующими нулями ПП Айтида не рекомендуется. Их наличие затруднит идентификацию товаров при загрузке данных из **«Frontol»** в Айтида.

Предпочтительным форматом обмена данными между ПП Айтида и **«Frontol»** является обмен текстовыми файлами. При выгрузке данных из Айтида, данные о товарах и других справочниках записываются в текстовый файл, который дополняется файлом-флагом. Программа **«Frontol»** реагирует на появление файла-флага загрузкой данных, обнаруженных в основном файле с данными. Имена и расширения имен файлов и файлов-флагов, могут быть любыми. При этом, содержимое этих файлов всегда представляет собой текст, который однозначно интерпретируется каждой стороной обмена данными.

Файлы выгрузки из ПП Айтида содержат информацию о товарах, скидка, дисконтных картах и т.п. данные. Файлы-флаги - содержат в себе команды для программы **«Frontol»** которые указывают ей, какие действия необходимо предпринять – загрузить ли данные в базу данных **«Frontol»**, либо выгрузить накопленные кассовые транзакции, для загрузки из в ПП Айтида.

> **Примечание!** *Если имеются коды с лидирующими нулями, то SQL-запрос для перегенерации кодов товаров, можно получить у партнера в регионе, который обслуживает программные продукты Айтида.*
{.is-info}


Для настройки обмена с кассовой программой зайти в **Справочник торгового оборудования** и создать карточку торгового оборудования.

**Меню Параметры - Торговое оборудование**

**![](/images/admin-guide/equipment/5e416652950ca144a70bf71211382952.png)**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/7a1f186e0397727b1706e03977e74a84.png)

**Имя ODBC соединения —** может содержать определённое в системе Windows имя ODBC соединения к базе данных фронт системы. Данное имя может быть использовано профилем оборудования для получения и выгрузки данных напрямую в таблицы фронт системы. В стандартной версии обмена данными, в этом поле может быть указано соединение с базой данных «Frontol».

**Строка соединения —** может содержать строку соединения в формате ODBC. Используется вместо имени ODBC соединения, для того, чтобы не настраивать на каждом рабочем месте ODBC соединения с одинаковыми именами.

> **Внимание!** *Стандартная строка соединения с базой данных «Frontol» и имеет следующий вид:*  **Driver=Firebird/InterBase(r) driver;Dbname=[Полный путь к базе данных];CHARSET=NONE;PWD=masterkey;UID=SYSDBA;**
{.is-warning}


### Вкладка «Выгрузка данных»

**Поля «Имя файла» и «Имя файла флага» —** необходимо указать полный путь и имена файлов для обмена данными с фронт системой. Файлы могут располагаться, как на локальных дисках, так и в сети, в том числе на синхронизируемых дисках в Интернет.

**Разделитель —** разделитель целой и дробной части при файловом обмене данными. Разные фронт системы по-разному загружают числа с дробной частью. Есть системы, которые используют в качестве разделителя только точку (.), другие используют региональные настройки своих систем, для определения разделителя. Подробнее о настройке в подразделе [Настройка региональных стандартов](#настройка-региональных-стандартов).

**Способы доставки —** позволяют использовать различные способы обмена с торговым оборудованием (e-mail, FTP, клиент Айтида). Кнопка в виде стрелки открывает Справочник способов доставки, где создаются карточки отправки/получения файлов обмена. Подробнее в разделе [Справочник способов доставки](#_Справочник_способов_доставки).

**Адрес эл. Почты —** при выборе способа доставки в данном поле можно указать собственный адрес электронной почты для данной фронт системы. Если адрес не указан, то будет использован адрес, указанный в способе доставки.

**Флаг «Не выгружать остатки» —** позволяет определить, какие команды необходимо передать фронт системе для того, чтобы она загрузила рассчитанные остатки товаров. Профиль оборудования может по своему усмотрению трактовать данный параметр. По умолчанию, переключатель установлен в положение «не выгружать остатки» и никаких дополнительных команд не подается в фронт системы.

**Флаг «Перезаписывать»** - при повторной выгрузке данных в кассовую программу «Frontol», значения начальных остатков товара в кассовой программе пере запишутся или суммируются, а информация в поле «Продано» останется без изменений. Данные параметры преобразуются в следующие команды: для «Frontol» указывается команда \$\$\$REPLACEQUANTITYWITHOUTSALE, для Штрих-М указывается команда \$\$\$RPL.

**Флаг «Добавлять»** – в момент повторной выгрузки данных в кассовую программу «Frontol», данные о начальном остатке товара суммируются, а информационное поле «Продано» в карточке ТМЦ в Фронтоле останется неизменным. Данные параметры преобразуются в следующие команды: для «Frontol» указывается команда \$\$\$ADDQUANTITY, для Штрих-М указывается команда \$\$\$ADD.

**Флаг «Выгружать разрезы товаров» —** станут активными переключатели: «Карточки и разрезы», «Карточки», «Разрезы».

**Карточки и разрезы —** после выгрузки в кассовую программу «Frontol», в справочнике товаров выгружаются карточки товаров, соответствующие конкретным разрезам и выгружаются комбинации разрезов с привязкой к основной карточке товара.

**Карточки —** выгружаются карточки товаров, соответствующие конкретным разрезам. Комбинации разрезов не выгружаются.

**Разрезы —** карточки товаров, соответствующие конкретным разрезам не выгружаются. Выгружаются основные карточки товаров и комбинации разрезов с привязкой к основной карточке товара.

**Флаг «Выгружать коды налогов» —** появляется возможность выгрузить ставку налога для каждого товара в кассовую программу «Frontol».

> **Внимание!** *Для использования опции* **«Выгружать коды налогов»** *необходимо:*  *В* **«Frontol»** *в* **«Справочнике налогов»** *ВРУЧНУЮ создать карточки налогов, с кодами, идентичными карточкам* **«Справочнике кодов налогов»** *в Айтиде.*  *В карточке кассы установить флаг* **«Выгружать коды налогов»***.*
{.is-warning}


**Флаг «Загружать весы через ККМ» —** позволяет осуществлять загрузку весового товара в весы через ККМ. При этом, необходимо указать кол-во PLU-кодов используемых весов с ПЭ.

### Вкладка «Загрузка данных»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/8277936c583b5c466bf3ce25b8cee281.png)

**«Имя файла» и «Имя файла флага» —** поля заполняются вручную или, нажав кнопку «Выбрать файл для загрузки».

**Способы доставки —** позволяют использовать различные способы обмена с торговым оборудованием (e-mail, FTP, клиент Айтида). При использовании файла флага и способов доставки, файл флага будет отправлен фронт системе используя способ доставки указанный на закладке «Выгрузка данных». Подробнее в разделе [Справочник способов доставки](#_Справочник_способов_доставки).

**Флаг «Ручной обмен данными при загрузке» —** устанавливается при ручном обмене данными с кассовой программой (без использования файла-флага). Например, Кассовая программа автоматически формирует файл выгрузки (для Айтида – файл загрузки) при закрытии смены. Для того, чтобы данные загрузились в ПП Айтида, следует установить вышеупомянутый флаг.

**Флаг «Использовать при автоматической загрузке»** — признак используется совместно со службой IDMService, настроенной на автоматический прием данных от фронт-систем. Если признак установлен, то служба будет обрабатывать данные от этой фронт системы.

> **Внимание!** *Не следует путать с автоматическим обменом с использованием файла-флага. При загрузке данных из кассы с использованием файла-флага, но без службы Айтида, данный флаг устанавливать* **не требуется.**
{.is-warning}


**Флаг «Проверять признак загрузки файла» —** устанавливается для контроля повторной загрузки ранее загруженных в программу файлов. При установке этого флага будет проанализирован признак \#/@. Если в первой строке файла с транзакциями содержится символ «@», то этот файл загружен не будет и на экране отобразится соответствующее сообщение.

**Флаг «Не сохранять транзакции» —** по умолчанию, в процессе загрузки данных все прочитанные кассовые транзакции записываются в базу данных. Если нет необходимости в сохранении этих транзакция, а они могут занимать достаточно большой объем, следует установить данный флаг.

**Номер последней загруженной транзакции —** после каждой загрузки данных будет устанавливаться актуальные номер. В случае внесения изменений во фронт систему, обновлении ее базы и других работах, необходимо переустановить значение этого поля на новое.

**Дата и время последней загрузки данных —** носит информативный характер и обновляется после каждой операции «загрузка».

> **Примечание!** *При необходимости загружать несколько файлов данных за одну процедуру приема данных, в поле* **«Имя файла»** *можно указать* **«Шаблон имени файла»***. При этом, если файлы доставляются службой доставки, то в карточке способа доставки необходимо указать, чтобы прикрепленные файлы сохранялись с уникальными именами.*
{.is-info}

> **Внимание!** *Если используется файл-флаг и не установлен признак* **«Ручной обмен данными при загрузке»***, то формируется файл-флаг в указанном каталоге. Если указан способ доставки данных на закладке «Выгрузка данных»***,** *то файл-флага доставляется указанным способом доставки.*
{.is-warning}


> **Примечание!** *Предусмотрена возможность задания альтернативных параметров обмена, например, для автоматической загрузки данных из ККМ.*
{.is-info}


### Вкладка «Прочие параметры»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/27b7775ad3cfc8d76e743d86471bfe51.png)

**Регистрац. номер —** регистрационный номер кассы (необязательно). Значение поля может использоваться в печатных и отчетных формах.

**Фирма —** необходимо выбрать из выпадающего списка юридическое лицо, от имени которого будут выписываться документы кассовой смены, загруженные из данной кассы. Используется для определения кода организации при загрузке данных, если не указаны коды обрабатываемых ФР. Список юридических лиц подхватывается из справочника собственных юридических лиц (Меню Справочники - Фирмы).

**Склад —** следует выбрать склад, с которого будет производиться списание товаров. Склад нахождения оборудования. Используется как основной склад списания/оприходования ТМЦ при загрузке данных. Список складов формируется из справочника складов (Меню Справочники - Склады).

**Денежный карман —** код денежного кармана, в который должны поступать денежные средства от продажи ТМЦ и услуг.

**Список «Фискальные регистраторы» —** в нижней части окна следует указать код фискального регистратора (ФР), который настроен на ПК кассы, а также выбрать фирму, которая ему соответствует. Одна фронт система может работать с несколькими фискальными регистраторами. При загрузке данных информация об организации, произведшей продажу, будет браться именно из этой таблицы. Кроме того, стандартная загрузка данных будет обрабатывать транзакции только тех ФР, которые присутствуют в данном списке

> **Внимание!** *Для обработки транзакций, относящихся **в целом ко всему чеку**, например, закрытие чека, оплата чека и т.п., **в список ФР** необходимо добавить **ФР с кодом 0**. При этом выбор юридического лица для такого ФР не имеет значения.*
{.is-warning}


>**Примечание!** *При использовании нескольких ФР на одной кассе, в нижнюю часть окна карточки следует добавить несколько юридических лиц и **указать коды ФР**, которые им соответствуют. Опция используется при разделении документов кассовой смены по ФР в момент загрузки данных.*
{.is-info}

>**Внимание!** *В случае **несоответствия** кода ФР в файле с транзакциями и в нижней части карточки ККМ в системе Айтида, при попытке загрузить файл с транзакциями, система выдаст сообщение **«В файле выгрузки не обнаружены транзакции для данного ФР»**.* 
{.is-warning}


>**Внимание!** *В программных продуктах серии «Айтида Retail» реализована работа с весами с печатью этикеток* **Масса-К** *для* **Driver-R,** *как с ККМ***.** [*Руководство по интеграции с весами Масса-К*](http://itida.ru/download/docs/MassaK/MssaKKKM.pdf)**.**
{.is-warning}


### Настройка региональных стандартов {#настройка-региональных-стандартов}

Разделитель целой и дробной части числа необходимо настроить в соответствии с настройками ПК кассы. Символ-разделитель указывается в форме **«Язык и региональные стандарты».**

**Меню Пуск – Панель управления – Язык и региональные стандарты.**

1.  На закладке **«Региональные параметры»** нажать на кнопку настройка:

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/3fdcef39a6c9c93ecbd17fc36b6cbca8.png)

2.  В открывшемся окне **«Настройка региональных параметров»** задан разделитель целой и дробной частей.

![](/images/admin-guide/equipment/60dcb2dfc8fb48fdd9d1002e0f80538c.png)

# Весы с печатью этикеток

Данный тип оборудования доступен для следующих производителей: Айтида, Атол, Штрих-М, Прочие. Для всех вариантов используются общие параметры настройки. В данный тип оборудования предусмотрена только выгрузка данных. Далее, весы печатают этикетку, которая может быть использована для определения кода и веса взвешенного товара.

При использовании профиля оборудования возможна работа с весами различных производителей. Без использования профиля оборудования поддерживается работа с оборудованием, поддерживаемым драйвером компании Атол или драйвером компании Штрих-М.

> **Внимание!** *В программных продуктах серии* **«Айтида Retail»** *реализована работа с весами с печатью этикеток* **ТОЛЬКО** *в конфигурациях:* **Pos версия,** **EаsyBOX, Минимаркет, Супермаркет.**
{.is-warning}

> **Внимание!** *В программных продуктах серии* **«Айтида Retail»** *реализована работа с весами с печатью этикеток Масса-К для Driver-R. [Руководство по интеграции с весами *Масса-К*](http://itida.ru/download/docs/MassaK/MssaKScalePLU.pdf).*
{.is-warning}


Перед настройкой весов с печатью этикеток необходимо подключить весы к компьютеру и установить необходимый драйвер весов с печатью этикеток из комплекта поставки оборудования. Затем открыть справочник торгового оборудования и создать карточку весов с печатью этикеток.

**Меню Параметры - Торговое оборудование**

![2013-04-09_093531.png](/images/admin-guide/equipment/675b92d1079e76385c4450cace9ddd7c.png)

**Поля «Наименование», «Торговая марка», «Серийный №» и «Производитель»** — заполняются в соответствии с данными устройства.

> Для работы с весами марки **Штрим-М**, используя драйвер компании-разработчика Штрих, в поле производитель следует выбрать **ШТРИХ**. Затем, в поле имя класса следует выбрать значение **addin.drvlp.**
{.is-warning}


**Выпадающий список «Тип оборудования» —** необходимо выбрать тип оборудования (весы с печатью этикеток).

**Выпадающий список «Профиль» —** выбрать профиль весов.

**Поле «Имя класса» —** Если не используется профиль оборудования, то необходимо указать имя класса, реализующего драйвер для работы с оборудованием. При указании профиля не обязательно указывать имя класса, т.к. профиль может самостоятельно использовать любые зарегистрированные в системе классы.

**Кнопка «Настройка драйвера оборудования» —** если не указан профиль оборудования, то будет вызван метод драйвера «ShowProperties». Если указан профиль оборудования, то будет вызвана соответствующая обработка. После выполнения обработки у профиля будет запрошено новое количество зарегистрированных в драйвере устройств и будет обновлен список в параметре «Устройство».

![2013-04-09_093730.png](/images/admin-guide/equipment/78598a8ae7c5976f1cb69ecaa22e4452.png)

**Количество памяти —** позволяет указать количество ячеек памяти в весах. Используется в форме для работы с весами и генерацией PLU.

> Многие весы с печатью этикеток работают с ключом защиты. Без ключа защиты драйвер весов будет работать в демонстрационном режиме, и выгружать товары с PLU от 1 до 10.
{.is-warning}


**Размер шрифта** — указать размер шрифта на этикетке. Может быть использовано профилем оборудования для передачи в устройство. В стандартном обмене используется для устройств, работающих с драйвером компании Атол.

**Выпадающий список «Устройство»** — в соответствии с настроенным драйвером торгового оборудования выбирается пред настроенное устройство с уникальным именем.

**Выпадающий список «Склад нахо**ж**дения»** — выбирается склад, к которому будет прикреплено устройство.

**Единица веса** — указывается единица веса (кг, гр. и т. д.).

**Флаг «Выводить комментарии на этикетку» —** указывает на необходимость выгрузки комментариев в оборудование. При использовании профиля оборудования, будут вызваны соответствующие обработки. В стандартном обмене используется для устройств, работающих с драйвером компании Атол.

**IP-адрес** — если устройство подключено к локальной сети, то необходимо указать его IP-адрес для передачи этой информации драйверу устройства.

**Пароль админ**-**ра** — для реализации некоторых профилей оборудования для работы с весами необходимо указывать пароль администратора весов, для загрузки информации в весы.

> **Примечание!** *Выгрузка товаров в весы производится в форме* **«Обмена данными с оборудованием»***.*
{.is-info}


Для ввода PLU у товаров необходимо в Справочнике ТМЦ вызвать опцию «Работа с группами весов» ![2013-04-09_094111.png](/images/admin-guide/equipment/61f648e3727885761689088f294f5af0.png).

![2013-04-09_094220.png](/images/admin-guide/equipment/165a1688401ed10cd77204f0034a45bc.png)

Откроется окно «Ввод PLU для товаров и весов». В левой части окна создаются группы весов, с перечнем весов в каждой группе. В правой, табличной части перечисляются товары, ассоциированные с определёнными весами, для каждого из которых необходимо сгенерировать PLU соответствующей кнопкой.

Для сохранения нажать кнопку «Записать»

![2013-04-09_094442.png](/images/admin-guide/equipment/092d1bddbab9b938a8a8ddfd77d5fd8a.png)

# Весы без печати этикеток

Данный тип оборудования доступен для следующих производителей: Айтида, Атол, CAS, Прочие. Для всех вариантов используются общие параметры настройки.

Для данного типа оборудования не предусмотрена выгрузка данных. Может производиться только чтение веса из устройства. Без использования профиля оборудования поддерживается работа с оборудованием Атол или драйвером компании CAS.

**Номер порта —** номер COM порта, к которому подключено устройство.

**Склад нахождения —** может использоваться для определения цены или остатка на складе. В стандартной обработке не используется.

**Единица веса —** единица измерения, в которой драйвер весов или профиль оборудования возвращают вес. Используется для пересчета в единицу измерения товара в документе.

**Пароль администратора —** для реализации некоторых профилей оборудования для работы с весами необходимо указывать пароль администратора весов.

> **Примечание!** *Обмен данными с весами без печати этикеток в системе Айтида* **не предусмотрено***. Реализованы только функции чтения веса с весов в документах осуществляющих движение ТМЦ и в форме регистрации продаж. В стандартной конфигурации чтение веса осуществляется при нажатии клавиши* **F9***.*
{.is-info}


> **Внимание!** *В программных продуктах серии «Айтида Retail» реализована работа с весами с печатью этикеток Масса-К для Driver-R. [*Руководство по интеграции с весами Масса-К*](http://itida.ru/download/docs/MassaK/MssaKScale.pdf).*
{.is-warning}


# Терминал сбора данных

В программных продуктах серии «Айтида» реализована работа со всеми терминалами сбора данных для следующих производителей: Айтида, Атол, Штрих-М, Прочие. Для всех вариантов используются общие параметры настройки. Для данного типа оборудования предусмотрен двусторонний обмен данными.

Обмен с ТСД похож на обмен с фронт системами, но с более широким спектром применения и возможностями настройки.

Настройка взаимодействия системы Айтида с ТСД, в сложных ситуациях, может двухуровневая. На нижнем уровне используется профиль оборудования, реализующий интерфейс чтения и записи данных в устройство, на втором уровне используется конфигурация обмена данными с ТСД.

Предполагается, что устройство ТСД состоит из набора таблиц с полями данных. Профиль оборудования организует передачу данных между системой Айтида и таблицами устройства. При этом «физического» устройства может и не быть. Чтение и запись могут производиться из разных источников данных: таблиц базы данных, текстовых файлов и т. п.

В качестве параметров профилю передаются номер таблицы и номер (имя) поля. Профиль возвращает или устанавливает значение указанного поля.

Конфигурация обмена данными с ТСД описывает соответствие между полями в таблицах ТСД и полями документов в системе Айтида.

Обмен данными с ТСД может производиться двумя способами.

1.  С использованием формы «Обмен данными с оборудованием».
2.  Из документов, осуществляющих движения ТМЦ:

    Загрузка и выгрузка данных из журналов документов.

    Загрузка и выгрузка из формы документа. При загрузке данных в форму документа система Айтида игнорирует поля разделители документов в ТСД. Все имеющиеся данные в ТСД загружаются в один документ.

Для того, чтобы подключить ТСД к компьютеру и установить соответствующий драйвер терминалов сбора данных необходимо открыть окно теста драйвера терминала сбора данных. Настроить связь с терминалом и задать имя устройства.

Для настройки обмена с ТСД зайти в **«Справочник торгового оборудования»** и создать карточку торгового оборудования.

**Меню Параметры - Торговое оборудование**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/12cfc4ac3932c81e6d351f8de3af3d7a.png)

**Поля «Наименование», «Торговая марка», «Серийный №» и «Производитель»** — заполняются в соответствии с данными устройства.

**Выпадающий список «Тип оборудования»** — необходимо выбрать тип оборудования.

**Имя класса** — если не используется профиль оборудования, то необходимо указать имя класса, реализующего драйвер для работы с оборудованием. При указании профиля не обязательно указывать имя класса, т.к. профиль может самостоятельно использовать любые зарегистрированные в системе классы

**Кнопка «Настройка драйвера оборудования»** — если не указан профиль оборудования, то будет вызван метод драйвера «ShowProperties». Если указан профиль оборудования, то будет вызвана соответствующая обработка. После выполнения обработки у профиля будет запрошено новое количество зарегистрированных в драйвере устройств и будет обновлен список в параметре «Устройство».

**Выпадающий список «Устройство»** — позволяет выбрать конкретное устройство из списка зарегистрированных в драйвере устройств.

## Вкладка «Общие параметры»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/48ea9d55b021eaeb3de9c97e0b2c0770.png)

**Выпадающий список «Склад нахождения»** — выбирается склад, к которому будет прикреплено устройство. Может использоваться для определения цены или остатка на складе. В стандартной обработке используется для определения выгружаемой цены товара.

**Выпадающий список «Юридическое лицо»** — выбирается фирма, к которому будет прикреплено устройство. Используется как значение по умолчанию при загрузке документов из устройства.

**Флаг «Сохранять порядок строк в создаваемых документах» —** установка признака предписывает системе не производить никаких манипуляций с полученными из устройства данными. В противном случае, данные будут сгруппированы по кодам товаров. При этом, порядок следования записей может быть нарушен. Используется при загрузке данных в текущий документ. При загрузке в журнале документов или в Форме обмена данными с оборудованием, данный флаг игнорируется.

## Вкладка «Параметры обмена данными с ТСД»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/6477cfd8adc382115df3f13830280862.png)

> **Примечание!** *Система Айтида поддерживает два варианта настройки формата обмена данными с ТСД.* **Упрощенный формат** *- доступна одна таблица для записи в ТСД, одна таблица для загрузки данных из ТСД и шесть стандартных полей для выгрузки и загрузки данных.* **Расширенный формат***, использующий конфигурацию обмена данными с ТСД. Этот формат позволяет более гибко описать взаимодействие между системой Айтида и ТСД.*
{.is-info}


**Флаг «Расширенная настройка обмена данными» и выпадающий список «Конфигурация»** — активирует выпадающий список «Конфигурация», указывает на использование настроенной конфигурации обмена данными с ТСД.

**Конфигурация —** используемая расширенная конфигурация обмена.

**Поле «Номера формы для выгрузки» «и загрузки данных из ТСД»** — дает возможность установить номера форм с выгружаемыми кодами товаров, следует подставить значения, определенные при настройке драйвера терминала сбора данных.

**Флаг «Выгружать коды товаров отдельными записями»** — установка флага указывает системе на необходимость выгружать данные о товарах дважды. Второй раз в поле штриховой код выгружается код товара.

**Поля «Для выгрузки в ТСД» и «Для загрузки из ТСД»** — позволяет установить по каким критериям производить загрузку/выгрузку (код, ШК, количество и т. д.).

> **Внимание!** *Порядок полей важен, т. к. обращение к полям в упрощенном формате производится **по номеру поля**. Загрузка данных в упрощенном формате формирует всегда **только один документ**. Тип документа определяется журналом документов, в котором производится загрузка или формой обмена данными с оборудованием.*
{.is-warning}


# Фискальный регистратор

В программных продуктах «Айтида» реализована работа со всеми фискальными регистраторами (ФР), которые поддерживаются драйвером АТОЛ-технологии. Для всех вариантов используются общие параметры настройки. Данный тип оборудования используется в Форме регистрации продаж. При использовании профиля оборудования возможна работа с фискальными регистраторами и принтерами чеков различных производителей. Без использования профиля оборудования поддерживается работа с оборудованием, поддерживаемым ДТО.

Необходимо подключить ФР к компьютеру и установить соответствующий драйвер АТОЛ-технологии. Открыть окно теста драйвера и настроить связь с устройством и задать его имя. Для настройки в ПП Айтида создать карточку торгового оборудования.

**Меню Параметры - Торговое оборудование**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/3a7b21cba7c998a0fe296fad0a32524f.png)

**Поля «Наименование», «Торговая марка», «Серийный №» и «Производитель»** — заполняются в соответствии с данными устройства.

**Выпадающий список «Тип оборудования»** — необходимо выбрать тип оборудования.

**Имя класса** — если не используется профиль оборудования, то необходимо указать имя класса, реализующего драйвер для работы с оборудованием. При указании профиля не обязательно указывать имя класса, т. к. профиль может самостоятельно использовать любые зарегистрированные в системе классы.

**Кнопка «Настройка драйвера оборудования»** — если не указан профиль оборудования, то будет вызван метод драйвера «ShowProperties». Если указан профиль оборудования, то будет вызвана соответствующая обработка. После выполнения обработки у профиля будет запрошено новое количество зарегистрированных в драйвере устройств и будет обновлен список в параметре «Устройство».

**Выпадающий список «Устройство»** — в соответствии с настроенным драйвером торгового оборудования выбирается пред настроенное устройство с уникальным именем.

## Вкладка «Общие параметры»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/b036a0310b1f42c8611bafaffd07e645.png)

**Выпадающий список «Склад нахождения»** — выбирается склад, к которому будет прикреплено устройство. Используется как основной склад списания/оприходования ТМЦ при загрузке данных.

**Выпадающий список «Денежный карман»** — код денежного кармана, в который должны поступать денежные средства от продажи ТМЦ и услуг.

**Выпадающий список «Юридическое лицо»** — владелец оборудования. Используется для определения кода организации при загрузке данных, если не указаны коды обрабатываемых ФР.

**Номер ФР** — указывается номер ФР. Значение поля может использоваться в печатных и отчетных формах.

**Поле «Номер смены»** — При использовании принтеров чеков, которые не поддерживают сменную работу, в этом поле хранится номер последней открытой смены.

**Поле «Номер чека»** — При использовании принтеров чеков, которые не поддерживают нумерацию чеков, в этом поле хранится номер последнего чека.

**Флаг «Отсоединяться от устройства после окончания операции»** — указывает системе, что необходимо освободить устройство (закрыть порт, соединение) после совершения каждой операции.

**Флаг «Разрешить ручные скидки на позицию»** — разрешает оператору применять ручные скидки на позицию в форме регистрации продаж, при использовании данного оборудования.

**Флаг «Разрешить ручные скидки на чек»** — разрешает оператору применять ручные скидки на чек в форме регистрации продаж, при использовании данного оборудования.

**Флаг «Разрешить рунные скидки только Администратору»** — запрещает оператору применять ручные скидки на позицию и чек, а разрешает их только Администратору. Администратором считается сотрудник с указанным профилем 29 или 30 в карточке сотрудника.

**Флаг «Разрешить автоматические скидки на позицию»** — разрешает системе рассчитывать и применять автоматические скидки на позицию в чеке в форме регистрации продаж, при использовании данного оборудования.

**Флаг «Разрешить автоматические скидки на чек»** — разрешает системе рассчитывать и применять автоматические скидки на чек в форме регистрации продаж, при использовании данного оборудования.

**Флаг «Разрешить изменять цену»** — позволяет устанавливать цену продажи вручную.

**Флаг «Разрешить изменять название»** — позволяет менять название в строке чека в форме регистрации продаж.

## Вкладка «Печать чека»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/fc96995b082933b74c21fa33beff3423.png)

**Выпадающий список «Перенос строк»** — позволяет выбрать настройки переноса строк («Не переносить строки» - будет напечатана только часть строки, которая помещается по ширине чека. «Переносить строки по словам» - будет осуществлен перенос на новую строку в месте разрыва слов. «Переносить строки по заполнению строк» - будет осуществлен перенос на новую строку с символа, следующего за последним поместившемся символом в предыдущей строке.).

**Выпадающий список «Печать скидок»** — позволяет выбрать правила печати скидок в чеке. («Не печатать скидки», «Распечатать все скидки по позициям», «Печатать все скидки в итоге чека», «Печатать скидки по строкам и в итоге чека» - каждая скидка будет напечатана в той строке, в которой она был применена. Скидки на чек будут выведены в итогах чека.).

> **Внимание!** *По* *правилам работы с 54-ФЗ скидки на чек не допускаются. Поэтому допустимыми являются только два варианта – не печатать скидки и распределять скидки по позициям чека.*
{.is-warning}


**Поле «Выражение для печати строк чека»** — ввод данного выражения позволяет произвольным образом настраивать печать нефинансовых чеков на ФР и всех чеков на принтере чеков. Значение выражения будет вычислено для каждого печатаемого товара и выведено на принтер ФР или принтер чеков. В случае, если тип значения выражения будет отличным от строкового, строка будет пропущена. Для вывода нескольких строк необходимо использовать символы перевода строки (0x0D).

> **Примечание!** *Если не заполнить поле **«Выражение**», то будет использовано значение по умолчанию, содержащее наименование и цену товара.*
{.is-info}

> **Примечание!** *Для каждого выражения предусмотрена справка по формату данного выражения и доступным параметрам в момент вычисления выражения. Справка вызывается нажатием кнопки **«Просмотреть справку по формату выражения»**.*
{.is-info}


# Прайс-чекер

**Price checker** – это устройство, которое подключается к локальной сети предприятия и используется для контроля цен реализации в торговом зале.

Принцип действия заключается в чтении штрихового кода товара, отправки запроса на сервер и отображает информацию пришедшую в ответ. Система Айтида поддерживает два протокола обмена с подобными устройствами:

Price checker фирмы Штрих-М (**«Штрих - Price Checker»**).

Price checker фирмы Shuttle (Shuttle SG).

Для взаимодействия устройства с сервером, необходимо настроить службу **IDMService** таким образом, чтобы она отвечала на входящие запросы устройств. Так же необходимо настроить карточку торгового оборудования для каждого устройства проверки цен, в которой указать **IP адрес** устройства. Это необходимо для идентификации устройства и определения параметров ответа.

Работа с прайс-чекером Атол осуществляется иначе. ПЧ Атол поддерживает загрузку данных из системы учета, поэтому для работы с ним необходимо указать следующие параметры:

1.  Указать **«Тип оборудования»** **«ККМ (внешняя фронт система)»**.
2.  **«Профиль»** следует выбрать **«Передача данных в ПЧ АТОЛ»**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/2f334b327abc220d9d8425cc0c0a3307.png)

> **Внимание!** *Для использования **«Прайс-чекер Атол»** следует загрузить в **«Справочник** **Профилей оборудования**» профиль оборудования **«Передача данных в ПЧ АТОЛ»** и указать его в выпадающем списке **«Профиль»**, который можно скачать с сайта* [*itida.ru*](https://itida.ru/obnovleniya-i-profili/profili-oborudovaniya-algoritmy-parametry-i-funktsii)*.*
{.is-warning}


1.  Следует указать имена файлов в поле **«Имя файла»** – полный путь и имя файла выгрузки из Айтиды в ПЧ. В поле **«Имя файл флага»** – полный путь и имя файла-флага. Полный путь является путем к сетевой папке на работу, с которой настроен ПЧ. Устройство «читает» файл обмена из этой папке и записывает информацию, содержащуюся в файле обмена, в свою локальную базу данных.
2.  Если необходимо, следует задать значение переключателя **«Добавлять остатки»** и флажка **«Выгружать разрезы товаров»**.
3.  Выгрузка информации о ТМЦ в ПЧ выполняется на форме **«Обмен данных с оборудованием (релиз 2.2)»**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/2e8d566a92fc526669d52767eaedd66c.png)

4.  На вкладке «Оборудование» необходимо установить флажок «ККМ» и выбрать из «Справочника торгового оборудования» оборудование «Прайс чекер АТОЛ».
5.  Далее на вкладке «Выгрузка товаров» следует сформировать список товаров для выгрузки в ПЧ и нажать кнопку «Выгрузка». Сформированный список выгрузится в файл (полный путь и имя файла указываются в карточке торгового оборудования).

Результатом выгрузки будет файл выгрузки с данными о товарах в формате **АТОЛ** и файл-флаг. Файлы с изображениями товаров автоматически копируются с помощью профиля в папку **IMG**, находящуюся внутри папки для записи файла выгрузки данных в ПЧ. Если папка **IMG** отсутствует внутри папки для записи файла выгрузки данных в ПЧ, то она будет создана автоматически с помощью профиля.

**Экспорт изображений товаров из Айтиды в ПЧ Атол**

Изображения товаров должны храниться в формате **JPEG** в базе данных Айтиды, либо во внешних файлах. В последнем случае в базе данных Айтиды должна содержаться ссылка на соответствующий файл. Имена файлов с изображениями товара, скопированные в папку **IMG**, имеют вид:

**[код товара в главной базе.jpg], например: 1234.jpg.**

Изображение товара выбирается в режиме **«Справочник ТМЦ – Карточка ТМЦ – Основные реквизиты – Изображение ТМЦ»**. Экспорт изображений товаров из Айтиды в ПЧ Атол выполняется автоматически с помощью Профиля.

![Изображение выглядит как текст, снимок экрана, внутренний, компьютер Автоматически созданное описание](/images/admin-guide/equipment/ac4e95f38c534d0339b5ab9c3a697bfb.png)

Информация из файла выгрузки Айтиды при помощи ПО ПЧ попадает в локальную БД price-checker. Далее ПО ПЧ работает исключительно со своей локальной БД. Из ПЧ никакие данные не выгружаются.

В режиме отображения ПЧ показывает товар, цены и остатки по разрезам, аналоги. ПЧ также поддерживает отображение товаров-спутников, но в настоящее время, работа с ними не реализована в Айтида.

## Настройка профиля передачи данных в ПЧ

Перед началом работы необходимо выполнить настройку профиля. Для этого следует в разделе профиля «Команды выгрузки данных – Подготовка к выгрузке данных в ККМ» задать значения переменных профиля ПЕРЕЗАПИСЫВАТЬ_КАРТИНКИ и ВЕСТИ_ЖУРНАЛ.

Если значение переменной ПЕРЕЗАПИСЫВАТЬ_КАРТИНКИ равно 0, то при копировании в папку IMG ранее записанные файлы с изображениями товаров не будут перезаписываться. Если значение этой переменной равно 1, то ранее записанные файлы будут перезаписываться. По умолчанию значение переменной ПЕРЕЗАПИСЫВАТЬ_КАРТИНКИ равно 0. Режим «с перезаписью картинок» может быть полезен, когда требуется заменить имеющиеся изображения товаров на новые. Если перезаписывать имеющиеся изображения не нужно, следует оставить режим по умолчанию («без перезаписи картинок»).

Использование данного режима предпочтительнее, т.к. при нем не выполнятся повторное копирование имеющихся файлов, а, следовательно, будет уходить меньше времени на формирование файла выгрузки в ПЧ.

Если значение переменной ВЕСТИ_ЖУРНАЛ равно 1, то будет вестись журнал копирования изображений в ПЧ Атол (далее – Журнал). Журнал хранится в файле journ_copy_img.txt в папке, указанной в карточке торгового оборудования для ПЧ (в той папке, где хранится файл выгрузки данных в ПЧ). В журнал автоматически записывается информация об отсутствии изображений товаров и о различных несоответствиях, обнаруженных при копировании изображений в ПЧ. Если не требуется вести журнал, необходимо установить значение переменной ВЕСТИ_ЖУРНАЛ равным 0. По умолчанию значение этой переменной равно 1.

## Особенности экспорта изображений товаров

Профиль передачи данных в ПЧ Атол выполняет экспорт изображений товаров в формате JPEG в папку IMG из базы данных Айтиды или из внешних файлов в зависимости от того где найдено изображение (предпочтение отдается изображению внутри базы). Если изображения в формате JPEG для данного товара не найдено ни в базе, ни во внешнем файле, в Журнал записывается соответствующее сообщение.

В Журнал могут быть записаны сообщения следующих видов:

-   для товара [код товара в гл. базе] [код товара] [наименование товара] не найдено изображение товара ни в базе, ни во внешнем файле.
-   для товара [код товара в гл. базе] [код товара] «наименование товара] есть ссылка на файл [имя файла] ,но этот файл не найден по указанному пути.
-   для товара [код товара в гл.базе] [код товара] «наименование товара» в базе найдено изображение в формате [расширение файла], а нужно изобр. в формате jpg.
-   для товара [код товара в гл.базе] [код товара] «наименование товара] найден файл [имя файла] ,а нужно изображение в формате jpg.
-   для товара [код товара в гл.базе» «код товара» «наименование товара» есть ссылка на отсутствующий файл [имя файла],а нужно изображение в формате jpg.

    Сообщения в журнале позволяют проанализировать имеющуюся в базе данных информацию об изображениях товаров и, в случае необходимости, откорректировать базу данных (добавить отсутствующие изображения товаров, изменить неверные ссылки на правильные). В конце Журнала формируется итоговая часть, в которой указывается общая информация о результатах экспорта изображений в ПЧ, а также информация об обнаруженных несоответствиях.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/8566c6de45d0833b4d540185bb5a31d2.png)

## Прайс-чекер Штрих-М

Система Айтида предусматривает обмен данными с оборудованием сторонних производителей. Наиболее востребованное из них является Прайс-чекер **«Штрих-М»**. Поскольку принцип подключения этого оборудования принципиально отличается от подключаемого Прайс-чекера производства Атол, то для настройки прайс-чекера **«Штрих-М»** необходимо следующее.

1.  Запрограммировать устройство стандартной утилитой от **«Штрих**», чтобы задать в нем корректный **«IP-адрес»** и **«Маску подсети»**.
2.  Запустить **ISConfig.exe** и настроить службу **IDMService.exe**
3.  Указать в поле **«Порт менеджера price-checker»** номер порта для связи с устройством. По умолчанию это - **2004 порт**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/364f4bdf5ce0234cf8ac8f869b0bffe3.png)

4.  В справочнике **«Торговое оборудование»** создать карточку торгового оборудования для Прайс-чекера **«Штрих-М»**.

    ![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/82eb27db47241b9c6cfb4f5341f15f33.png)

5.  В карточке прайс-чекера **«Штрих-М»** обязательно указать **«Склад»** и **«IP-адрес устройства»**. Поле **«Выражение»** для заполнения не обязательно, в этом случае будет выведено наименование (40 символов) и цена товара.

# Форма «Обмен данными с оборудованием»

В системе Айтида реализована возможность выгрузки данных в оборудование. Возможна выгрузка товаров в ККМ и весы, выгрузка информации о скидках, дисконтных картах и клиентах владельцах карт. Выгрузка данных производится с помощью профиля оборудования.

Выгрузка данных производится отдельно с каждой вкладки данной формы, при этом каждый раз файл выгрузки создается заново. Система Айтида не позволит выгрузить данные с другой вкладки до тех пор, пока ранее выгруженная информация не будет загружена в ККМ.

Сначала необходимо загрузить в ККМ информацию о товарах и только после этого информацию о скидках. В противном случае **«Frontol»** выдаст ошибку.

> **Примечание!** *Имеется возможность реализовать автоматическую выгрузку данных в оборудование без участия оператора. При этом нет необходимости создавать отдельные профили оборудования для автоматической выгрузки данных. Могут быть использованы стандартные профили в форме* **«Обмена данными с оборудованием 2.2»***. Выгрузка данных осуществляется службой IDMService, для этого необходима настройка* **«ISConfig.exe»** *на закладке* **«Выгрузка данных программы»***. Настройка производится с указанием интервала проверки наличия события, индицирующего о том, что необходимо произвести выгрузку и указанием текста (скрипта) проверки наличия этого события.*
{.is-info}


**Меню Сервис – Обмен данными с оборудованием.**

Для формирования списка можно использовать следующие кнопки:

| Кнопка                                                               | Назначение                                                                                               |
|----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![2013-04-08_131819.png](/images/admin-guide/equipment/7555acfbc57146dc70959afc5e17e80b.png) | Кнопка **«Добавить»** товары/услуги/оборудование в список, вызывает справочник для дополнения списка товаров/услуг/оборудования.                                                                                                                                                                                                                                                                                                                         |
| ![2013-04-08_131826.png](/images/admin-guide/equipment/cf8b378f3a02e2392a3d5285a4ed7c64.png) | Кнопка удаляет выделенную строку из списка или позволяет **«Очистить весь список»**.                                                                                                                                                                                                                                                                                                                                                                     |
| ![2013-04-08_132003.png](/images/admin-guide/equipment/9f512a2fa04e37fbf21cc77f488f69e0.png) | Кнопка заполняет спецификацию формы товарами, услугами или оборудованием, соответствующими заданным условиям.  Имеется возможность **«Проверить список товаров на наличие повторяющихся штриховых кодов»** и/или **«Рассчитать цену на выбранном складе и загрузить штриховые коды»**. Для автоматического формирования списка товаров можно воспользоваться возможностью выбора **«Группы товаров для загрузки»** и/или **«Только остатки на складе»**. |
| ![2013-04-08_131812.png](/images/admin-guide/equipment/a30738f76133accdbb9bb6bc20fd5696.png) | Кнопка выгружает сформированный список товаров и услуг в оборудование.                                                                                                                                                                                                                                                                                                                                                                                   |
| ![2013-04-08_132032.png](/images/admin-guide/equipment/6eff5b637a191261c398a83b74654197.png) | Кнопка позволяет отказаться от выгрузки и закрывает окно Формы обмена данными.                                                                                                                                                                                                                                                                                                                                                                           |

## Вкладка «Оборудование»

![2013-04-08_133635.png](/images/admin-guide/equipment/8dd425d1992b53a97fbe93c4cdd77674.png)

На этой вкладке укажите оборудование, с которым будет производиться обмен. Это можно сделать, задав параметры для автоматического заполнения списка оборудования, либо добавив оборудование в список вручную, используя кнопки панели инструментов **«Формы обмена данными с оборудованием»**.

## Вкладка «Выгрузка товаров»

![2013-04-08_133654.png](/images/admin-guide/equipment/f795a89dc942205935eaa0974a478a06.png)

**Выпадающий список «Группа товаров для загрузки» —** позволяет выбрать для загрузки группу ресурсов из справочника групп ресурсов.

**Флаг и выпадающий список «Только остатки на складе» —** делает доступным выпадающий список складов. При выборе склада в ККМ будут выгружены товары, находящиеся на указанном складе.

**Флаг «Выгружать товары с нулевой ценой» —** разрешает выгрузку товаров с нулевой ценой.

**Флаг «Очистить список товаров перед загрузкой» —** из памяти ККМ перед загрузкой будет удалена вся номенклатура товаров. Если выгрузка производится во «Frontol», то в файл будет добавлена команда \$\$\$DELETEALLWARES.

**Флаг «Не удалять товары перед загрузкой» —** загружаемый список будет добавлен к имеющемуся в ККМ списку товаров. Если не установлен ни один флаг, то пред загрузкой из ККМ будут удалены товары, коды которых совпадают с кодами товаров выгружаемого списка. Если выгрузка производится во «Frontol», то в файл будет добавлена команда \$\$\$DELETEWARESBYWARECODE. При одновременной установке флагов приоритет будет иметь флаг «Очистить список товаров перед загрузкой» и из памяти ККМ перед загрузкой будет удалена вся номенклатура товаров командой \$\$\$DELETEALLWARES.

**Кнопка «Сформировать список товаров по указанным параметрам» —**  имеется несколько выпадающих пунктов, каждый из которых имеет свое назначение: **«Проверить список товаров на наличие повторяющихся штриховых кодов»; «Рассчитать цену на выбранном складе и загрузить штриховые коды».**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/994cae524be125545910312c9cf2904a.png)

Возможность **«Проверить список товаров на наличие повторяющихся штриховых кодов»**  реализована для обеспечения уникальности ШК во избежание ошибок при работе с конфигурациями ТСД или при проведении продаж на ККМ и т.п.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/032a8b74e6f92828a7222af1f67ef0e5.png)

Сформированный список товаров будет проверен и в случае обнаружения повторяющихся ШК, система Айтида создаст текстовый документ с выведенным списком товаров с одинаковыми ШК.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/4633ad5e8182d6e8392321c697534ec6.png)

Возможность **«Рассчитать цену на выбранном складе и загрузить штриховые коды»** реализована для отображения ШК и цены в списке выбранных товаров. Цена рассчитывается для указанного в форме склада.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/72221d149ab8748b5009f44f2a757c69.png)

В случае, когда склад в выпадающем списке **«Только остатки на складе»** на вкладке **«Выгрузка»** не выбран, то цены будут определяться складом по умолчанию, указанный в параметрах пользователя.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/2b39c2b75620dc0346e9c9f3085966f8.png)

## Вкладка «Выгрузка кассиров»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/03a0997ea813ab74ad839e8df6d57483.png)

На вкладке **«Выгрузка кассиров»** необходимо указать пользователей и сотрудников, которые будут пользоваться данной ККМ. Это можно сделать, задав параметры для автоматического заполнения списка пользователей и сотрудников, либо добавив пользователей и сотрудников в список вручную, используя кнопки панели инструментов **«Формы обмена данными с оборудованием»**.

## Вкладка «Скидки»

![2013-04-08_152745.png](/images/admin-guide/equipment/0272b72a50c5204644bf3494ce771d5c.png)

Флаги формы обмена на вкладке **«Скидки»** регулируют параметры выгрузки данных, которые имеют массу настроек по очистке списка загружаемых скидок/карт/клиентов при дальнейшей работе, например, с другим оборудованием.

Параметры

**Флаг «Удалять ставки перед загрузкой»**

**Флаг «Удалять объекты скидок перед загрузкой»**

**Флаг «Удалять клиентов перед загрузкой»**

**Флаг «Удалять схемы автоматических скидок»**

**Флаг «Удалять внутренние автоматические скидки»**

**Флаг «Удалять дисконтные карты перед загрузкой»**

позволяют передать фронт системе необходимые команды для очистки имеющихся во фронт системе данных перед загрузкой новых данных

### Вкладка «Схемы скидок»

При выгрузке схем скидок всегда будет происходить очистка списка схем скидок в ККМ, вне зависимости от установки флага **«Удалять объекты скидок перед загрузкой»**. Это связано с тем, что для выборочного удаления схем скидок необходимо знать внутренний код этих схем во **«Frontol»**. Поскольку системе Айтида эти коды неизвестны, необходимо очистить весь список и добавить заново.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/equipment/8d7bef7c1c39cda9ef56ac07a1ee1216.png)

### Вкладка «Дисконтные карты»

**![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/38129338ae719e3f6db3c99349e3ae6c.png)**

**Префикс номера дисконтных карт для загрузки —** позволяет сформировать список дисконтных карт, указав их общий префикс.

### Вкладка «Клиенты, владельцы дисконтных карт»

**Группа клиентов —** позволяет выбрать группу клиентов из ранее созданных групп в «Справочнике групп контрагентов».

**Флаг «Выгружать карты клиентов» —** добавляет в файл выгрузки информацию о дисконтных картах, связанных с выгружаемым списком клиентов.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/685f33621ba7a5d07ea4d6ee5cbc2211.png)

## Вкладка «Загрузка данных»

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/equipment/2fc0c35528c3aeb06304b7c30758ae95.png)

**Группа флагов в секции «Формировать документы раздельно» —** определяет порядок группировки данных в документах, которые будут формированы по итогам загрузки данных.

**Секция переключателей «Тип формируемых документов» —** определяет, какие документы будут сформированы по итогам загрузки данных.

**Флаг «Брать дату из ККМ» —** время сохраняемых транзакций берется из ККМ, а время документа кассовой смены берется на конец дня, также многодневные смены разбиваются по датам.

**Флаг «Дата» —** позволяет задать дату формируемых документов. При этом многодневные смены не будут разбиваться по датам.

**Флаг «Дата закрытия смены» —** время сохраняемых транзакций и документа кассовой смены приравнивается к времени закрытия смены.

**Флаг «Дата Z отчета» —** время сохраняемых транзакций и документа кассовой смены приравнивается к времени снятия Z отчета.

**Флаг «Новые продажи (с момента предыдущего снятия отчета)» —** в создаваемый документ попадут данные, определенные во фронт системе, как новые.

**Флаг «За период с...по» —** позволяет задать временной диапазон данных, которые будут запрошены у фронт системы.

**Флаг «Кассовые смены с...по» —** позволяет задать диапазон кассовых смен, которые будут запрошены у фронт системы.

**Флаг «Все продажи, хранящиеся в ККМ» —** позволяет запросить все данные, имеющиеся во фронт системе.

**Флаг «Загрузить последнюю закрытую кассовую смену» —** позволяет запросит транзакции последней закрытой кассовой смены.

**Флаг «Не использовать способы доставки» —** не использовать способы доставки, указанные в карточке торгового оборудования. Подробнее о способах доставки можно узнать из раздела [Справочник способов доставки](#_Справочник_способов_доставки).

**Флаг «Не отправлять файлы флагов через службу доставки»** — при установке файлы-флаги не отправляются.

**Флаг «Очистить почтовый ящик перед запросом новых данных» —** удаляются письма из почтового ящика перед запросом новых данных.

**Флаг «Очистить ТСД после загрузки —** при работе с ТСД установка признака подает команду на удаление данных из ТСД.

**Кнопка «Открыть журнал документов» —** позволяет открыть на просмотр документы, полученные после загрузки.
