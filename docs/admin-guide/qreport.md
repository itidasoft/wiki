---
title: Генератор отчетных форм
description: Руководство администратора
published: true
date: 2022-08-14T16:28:41.716Z
tags: генератор, создание отчетов, редактор отчетов
editor: markdown
dateCreated: 2022-08-14T14:25:11.528Z
---

Генератор отчетов предназначен для создания шаблонов форм отчетов, а также для редактирования уже имеющихся шаблонов форм.

**Меню Сервис – Справочник отчетных форм**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/538ef3a06ed3fb2070624aeb92162161.png)

В открывшемся окне **«Справочник отчетных форм»** следует выбрать необходимую карточку шаблона отчета для редактирования или создать новую. В главном окне **«Генератора отчетов»** отображаются: меню, панели инструментов, линейка, поле шаблона, строка статуса, поле отчета.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/0eb34fd6fc6407b6e573655fe57e1d9e.png)

# Список полей для генератора отчетов

Таблица с информацией для вывода в ценник содержит более 150 предопределенных полей:

| Наименование поля (Тип в SQL)                             | Описание                                                                                                                                                                         |
|------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| firm char(7)                                   | Фирма                                                                                                                                                                            |
| account char(3)                                | Учет                                                                                                                                                                             |
| viewpoint char(10)                             | Точка зрения                                                                                                                                                                     |
| clev char(3)                                   | Категория цены                                                                                                                                                                   |
| sklad char(3)                                  | Склад                                                                                                                                                                            |
| kolp float                                     | Количество                                                                                                                                                                       |
| **Основные поля**                                 |                                                                                                                                                                                  |
| nn char(10)                                    | Внутренний код                                                                                                                                                                   |
| maincode varchar(30)                           | Главный код                                                                                                                                                                      |
| ex_code varchar(50)                            | Код для связи с внешней системой                                                                                                                                                 |
| name varchar(250)                              | Наименование                                                                                                                                                                     |
| shortname varchar(250)                         | Краткое наименование                                                                                                                                                             |
| code varchar(50)                               | Артикул                                                                                                                                                                          |
| nnvid char(20)                                 | Вид товара (для алкогольных деклараций)                                                                                                                                          |
| excise char(6)                                 | Код акциза                                                                                                                                                                       |
| fexcise bit                                    | Признак акцизного товара                                                                                                                                                         |
| koef float                                     | Коэффициент                                                                                                                                                                      |
| code_sv varchar(20)                            | Группа для поставщика                                                                                                                                                            |
| store_period int                               | Срок хранения в днях                                                                                                                                                             |
| okdp char(10)                                  | Код ОКДП                                                                                                                                                                         |
| nngroup char(20)                               | Группа учета                                                                                                                                                                     |
| bgroup\_ char(10)                              | Бухгалтерская группа учета                                                                                                                                                       |
| kodn char(2)                                   | Код списка налогов                                                                                                                                                               |
| note varchar(1024)                             | Примечание                                                                                                                                                                       |
| declar char(30)                                | гтд                                                                                                                                                                              |
| warranty char(2)                               | Гарантия                                                                                                                                                                         |
| z_code char(6)                                 | Статья затрат (для услуг)                                                                                                                                                        |
| p_code char(6)                                 | Статья дохода (для услуг)                                                                                                                                                        |
| **Единицы измерения, значения**                    |                                                                                                                                                                                  |
| ed char(15)                                    | Основная единица измерения                                                                                                                                                       |
| ed\_ char(15)                                  | Указанная единица измерения (можно указать другую при печати ШК или в спецификации документа)                                                                                    |
| edd_litr char(15)                              | Единица измерения для объема                                                                                                                                                     |
| ed_weight char(15)                             | Единица измерения для веса                                                                                                                                                       |
| weight float                                   | Вес основной единицы                                                                                                                                                             |
| a_proc float                                   | Крепость                                                                                                                                                                         |
| a_proc_u float                                 | Крепость постащика                                                                                                                                                               |
| d_litr float                                   | Объем                                                                                                                                                                            |
| **Информация о производителе, поставке**           |                                                                                                                                                                                  |
| ftara bit                                      | Тара                                                                                                                                                                             |
| vendor varchar(20)                             | Код основного поставщика                                                                                                                                                         |
| importer varchar(7)                            | Код основного импортера                                                                                                                                                          |
| manuf char(50)                                 | Страна производства                                                                                                                                                              |
| manuf_code char(10)                            | Производитель                                                                                                                                                                    |
| tpack char(30)                                 | Тип упаковки                                                                                                                                                                     |
| inside float                                   | Вложение                                                                                                                                                                         |
| min\_ float                                    | Минимальный запас                                                                                                                                                                |
| max\_ float                                    | Максимальный запас                                                                                                                                                               |
| **Естественная убыль**                             |                                                                                                                                                                                  |
| lossrealization char(10)                       | Естественная убыль при реализации                                                                                                                                                |
| lossstore char(10)                             | Естественная убыль при хранении                                                                                                                                                  |
| lossreal_val float                             | Естественная убыль при реализации (конкретное значение)                                                                                                                          |
| lossstore_val float                            | Естественная убыль при хранении (конкретное значение)                                                                                                                            |
| **Флаги**                                          |                                                                                                                                                                                  |
| fractqty bit                                   | Запретить дробное количество                                                                                                                                                     |
| f_unmake bit                                   | Разрешение разбирать собранный комплект                                                                                                                                          |
| f_automake bit                                 | Признак автоматической сборки комплекта при списании                                                                                                                             |
| f_make bit                                     | Производится (собирается, разрешена сборка)                                                                                                                                      |
| f_buy bit                                      | Покупается                                                                                                                                                                       |
| f_sale bit                                     | Продатся                                                                                                                                                                         |
| f_nessassortment bit                           | Признак обязательного ассортимента                                                                                                                                               |
| f_nessgenbc bit                                | Признак обязательной генерации штрих, кода                                                                                                                                       |
| **Разрезы/характеристики**                         |                                                                                                                                                                                  |
| f_hchild bit                                   | Признак того, что у данного товара есть разрезы                                                                                                                                  |
| subcode char(10)                               | Код основного товара (для разрезов)                                                                                                                                              |
| f_subres bit                                   | Признак того, что данный товар является разрезом                                                                                                                                 |
| d_code char(10)                                | Код из справочника комбинаций характеристик                                                                                                                                      |
| **Цены**                                           |                                                                                                                                                                                  |
| price float                                    | Цена продажи из карточки                                                                                                                                                         |
| incena float                                   | Цена закупки                                                                                                                                                                     |
| margin_proc float                              | Процент наценки по умолчанию для данного ТМЦ                                                                                                                                     |
| **Дополнительные вычисляемые поля**                |                                                                                                                                                                                  |
| Крепость varchar(15)                           | Крепость в строковом виде                                                                                                                                                        |
| Вес varchar(15)                                | Вес в строковом виде                                                                                                                                                             |
| Объем varchar(15)                              | Объем в строковом виде                                                                                                                                                           |
| ВесОбъем varchar(15)                           | Вес/Объем в строковом виде (вес, а если не заполнен вес, то объем)                                                                                                               |
| barcode varchar(50)                            | ШК из карточки (первый из списка) или из формы Работа со штрихкодами                                                                                                             |
| СтранаПроизводитель varchar(250)               | Название страны-производителя из карточки ТМЦ                                                                                                                                    |
| Производитель varchar(250)                     | Наименование производителя из карточки ТМЦ                                                                                                                                       |
| plu char(10)                                   | Код в весах (первый из списка)                                                                                                                                                   |
| koef\_ float                                   | Коэффициент пересчета                                                                                                                                                            |
| Имя_папки varchar(250)                         | Наименование родительской папки при использовании структуры                                                                                                                      |
| cena float                                     | Цена                                                                                                                                                                             |
| cena\_ float                                   | Предыдущая цена                                                                                                                                                                  |
| Контрагент varchar(250)                        | Наименование контрагента                                                                                                                                                         |
| plu1 char(10)                                  | Первый (по коду оборудования) PLU                                                                                                                                                |
| plu2 char(10)                                  | Второй (по коду оборудования)PLU                                                                                                                                                 |
| plu3 char(10)                                  | Третий(по коду оборудования)PLU                                                                                                                                                  |
| plu4 char(10)                                  | Четвертый (по коду оборудования) PLU                                                                                                                                             |
| plu5 char(10)                                  | Пятый (по коду оборудования) PLU                                                                                                                                                 |
| ШК1 varchar(50)                                | Первый (по времени добавления) штриховый код                                                                                                                                     |
| ШК2 varchar(50)                                | Второй (по времени добавления) штриховый код                                                                                                                                     |
| ШК3 varchar(50)                                | Третий (по времени добавления) штриховый код                                                                                                                                     |
| ШК4 varchar(50)                                | Четвертый (по времени добавления) штриховый код                                                                                                                                  |
| ШК5 varchar(50)                                | Пятый (по времени добавления) штриховый код                                                                                                                                      |
| Группа varchar(250)                            | Наименование группы товара/услуги                                                                                                                                                |
| Налоги char(50)                                | Наименование списка налогов                                                                                                                                                      |
| ПроцентНаценки varchar(15)                     | Процент наценки                                                                                                                                                                  |
| МинЦена float                                  | Минимальная цена                                                                                                                                                                 |
| МаксСкидка float                               | Максимальная скидка                                                                                                                                                              |
| ГруппаРасчетаЦен varchar(250)                  | Группа расчета цен                                                                                                                                                               |
| Поставщик varchar(250)                         | Поставщик                                                                                                                                                                        |
| Импортер varchar(250)                          | Импортер/Производитель                                                                                                                                                           |
| КрепостьПоставщика varchar(15)                 | Крепость поставщика в строковом виде                                                                                                                                             |
| ВидПродукции varchar(250)                      | Вид продукции                                                                                                                                                                    |
| Скидка varchar(250)                            | Скидка                                                                                                                                                                           |
| ДопСвойство1 varchar(250)                      | Первое по порядку отображения в карточке доп. свойство                                                                                                                           |
| ДопСвойство2 varchar(250)                      | Второе по порядку отображения в карточке доп. свойство                                                                                                                           |
| ДопСвойство3 varchar(250)                      | Третье по порядку отображения в карточке доп. свойство                                                                                                                           |
| ДопСвойство4 varchar(250)                      | Четвертое по порядку отображения в карточке доп. свойство                                                                                                                        |
| ДопСвойство5 varchar(250)                      | Пятое по порядку отображения в карточке доп. свойство                                                                                                                            |
| ДопСвойство6 varchar(250)                      | Шестое по порядку отображения в карточке доп. свойство                                                                                                                           |
| ДопСвойство7 varchar(250)                      | Седьмое по порядку отображения в карточке доп. свойство                                                                                                                          |
| ДопСвойство8 varchar(250)                      | Восьмое по порядку отображения в карточке доп. свойство                                                                                                                          |
| ДопСвойство9 varchar(250)                      | Девятое по порядку отображения в карточке доп. свойство                                                                                                                          |
| ДопСвойство10 varchar(250)                     | Десятое по порядку отображения в карточке доп. свойство                                                                                                                          |
| НаименованиеДопСвойства1 varchar(250)          | Наименование первого по порядку отображения в карточке доп. свойства                                                                                                             |
| НаименованиеДопСвойства2 varchar(250)          | Наименование второго по порядку отображения в карточке доп. свойства                                                                                                             |
| НаименованиеДопСвойства3 varchar(250)          | Наименование третьего по порядку отображения в карточке доп. свойства                                                                                                            |
| НаименованиеДопСвойства4 varchar(250)          | Наименование четвертого по порядку отображения в карточке доп. свойства                                                                                                          |
| НаименованиеДопСвойства5 varchar(250)          | Наименование пятого по порядку отображения в карточке доп. свойства                                                                                                              |
| НаименованиеДопСвойства6 varchar(250)          | Наименование шестого по порядку отображения в карточке доп. свойства                                                                                                             |
| НаименованиеДопСвойства7 varchar(250)          | Наименование седьмого по порядку отображения в карточке доп. свойства                                                                                                            |
| НаименованиеДопСвойства8 varchar(250)          | Наименование восьмого по порядку отображения в карточке доп. свойства                                                                                                            |
| НаименованиеДопСвойства9 varchar(250)          | Наименование девятого по порядку отображения в карточке доп. свойства                                                                                                            |
| НаименованиеДопСвойства10 varchar(250)         | Наименование десятого по порядку отображения в карточке доп. свойства                                                                                                            |
| АдресИмпортера varchar(250)                    | Адрес Импортера/Производителя                                                                                                                                                    |
| ОГРНИмпортера varchar(15)                      | ОГРН Импортера/Производителя                                                                                                                                                     |
| **Разрезы, характеристики**                        |                                                                                                                                                                                  |
| НаименованиеОсновногоТовара varchar(250)       | Если товар является разрезом, то наименование основного товара ; если товар не является разрезом, то его наименование                                                            |
| ЗначенияХарактеристик1 varchar(8000)           | Список различных значений первой по порядку характеристики по всем существующим разрезам товара                                                                                  |
| ЗначенияХарактеристик2 varchar(8000)           | Список различных значений второй по порядку характеристики по всем существующим разрезам товара                                                                                  |
| ЗначенияХарактеристик3 varchar(8000)           | Список различных значений третьей по порядку характеристики по всем существующим разрезам товара                                                                                 |
| ЗначенияХарактеристик4 varchar(8000)           | Список различных значений четвертой по порядку характеристики по всем существующим разрезам товара                                                                               |
| ЗначенияХарактеристик5 varchar(8000)           | Список различных значений пятой по порядку характеристики по всем существующим разрезам товара                                                                                   |
| ЗначенияХарактеристикСОстатками1 varchar(8000) | Список различных значений первой по порядку характеристики по разрезам товара, по которым имеется положительный остаток по переданным в ценник складу и учету на текущую дату    |
| ЗначенияХарактеристикСОстатками2 varchar(8000) | Список различных значений второй по порядку характеристики по разрезам товара, по которым имеется положительный остаток по переданным в ценник складу и учету на текущую дату    |
| ЗначенияХарактеристикСОстатками3 varchar(8000) | Список различных значений третьей по порядку характеристики по разрезам товара, по которым имеется положительный остаток по переданным в ценник складу и учету на текущую дату   |
| ЗначенияХарактеристикСОстатками4 varchar(8000) | Список различных значений четвертой по порядку характеристики по разрезам товара, по которым имеется положительный остаток по переданным в ценник складу и учету на текущую дату |
| ЗначенияХарактеристикСОстатками5 varchar(8000) | Список различных значений пятой по порядку характеристики по разрезам товара, по которым имеется положительный остаток по переданным в ценник складу и учету на текущую дату     |
| Разрез1 varchar(512)                           | Наименование и значение первой характеристики подчиненного товара в соответствии с порядком, в котором хар-ки указаны в группе ресурсов                                          |
| Разрез2 varchar(512)                           | Наименование и значение второй характеристики подчиненного товара в соответствии с порядком, в котором хар-ки указаны в группе ресурсов                                          |
| РазрезЗ varchar(512)                           | Наименование и значение третьей характеристики подчиненного товара в соответствии с порядком, в котором хар-ки указаны в группе ресурсов                                         |
| Разрез4 varchar(512)                           | Наименование и значение четвертой характеристики подчиненного товара в соответствии с порядком, в котором хар-ки указаны в группе ресурсов                                       |
| Разрез5 varchar(512)                           | Наименование и значение пятой характеристики подчиненного товара в соответствии с порядком, в котором хар-ки указаны в группе ресурсов                                           |
| **Дополнительные поля, передаваемые формами**      |                                                                                                                                                                                  |
| objcode char(3)                                | Код типа объекта                                                                                                                                                                 |
| spec_ic int                                    | Идентификатор строки объекта                                                                                                                                                     |
| dbase varchar(250)                             | Имя базы                                                                                                                                                                         |
| mark bit                                       | Признак                                                                                                                                                                          |
| rownum int                                     | Порядок, в котором строки отображены в программе (в localtablename этот столбец назван identity_column)                                                                          |
| folder bit                                     | 1, если запись соответствует папке, иначе 0                                                                                                                                      |
| parent int                                     | Идентификатор родительской папки                                                                                                                                                 |
| expdate datetime                               | Срок годности                                                                                                                                                                    |
| client char(7)                                 | Код контрагента                                                                                                                                                                  |
| НомерПоставщика char(30                        | Номер накладной поставщика                                                                                                                                                       |
| sprcode char(3)                                | Код справочника, которому принадлежат элементы                                                                                                                                   |
| f_weight bit                                   | Признак того, что единица измерения веса                                                                                                                                         |

# Добавление новых полей

Существенно упрощена процедура добавления новых полей в печатные формы. Нажатие кнопки **«Вставка ячейки»** на панели инструментов генератора отчетов. Необходимо выбрать место для расположения поля в шаблоне посредством нажатия кнопки мыши. При нажатии по добавленному полю откроется окно для ввода значения. В ячейку вводится название поля.

Для добавления поля в ценник не нужно редактировать код, все ценники и этикетки поддерживают печать:

Через форму работы с ценниками

Через форму работы со штриховыми кодами

Из документа, имеющего многострочную часть (спецификацию)

Из журнала документов, имеющих многострочную часть (спецификацию)

Из справочника товаров как печатная форма для отдельного элемента

Из справочника товаров как печатная форма для списка элементов

Из справочника услуг как печатная форма для отдельного элемента

Из справочника услуг как печатная форма для списка элементов

Внутри каждого из ценников и этикеток доступны опции:

Включение/отключение вывода ценников в количестве, равном количеству товара

Вывод округленного в большую/меньшую стороны количества ценников для дробного количества товара

Для товаров в нулевом количестве - не выводить на печать/напечатать один экземпляр ценника

Для выбора опций необходимо перейти в режим редактирования шаблона и открыть окно **«текст входа отчет»**.

![](/images/admin-guide/qreport/463a0208b46a3b485d30255274c588b6.png)

Ценники и этикетки оснащены встроенными механизмами диагностики ошибок и отладки программы. Запрошенные для вывода в ценники и этикетки, данные предварительно заносятся в глобальные временные таблицы на сервере (с именами **\#\#pricetag** и **\#\#productlabel** соответственно) и только затем запрашиваются из них. Это позволяет без необходимости внесения каких-либо изменений в код пользовательских ценников и этикеток расширять перечень полей и расчетов для вывода в ценник, а также использовать корректировки расчетов существующих полей - для этого достаточно установить обновление структуры БД на сервере, содержащее последние версии используемых хранимых процедур и функций. Таблицы удаляются при закрытии окна генератора отчетов и затем повторно создаются при следующем формировании ценников или этикеток.

# Элементы главного меню

Элементы главного меню: **«Файл»**, **«Правка»**, **«Просмотр»**, **«Формат»**, **«Данные»**, **«Окно»** и **«Справка»** – отражают основные задачи, которые приходится решать при создании и редактировании шаблона отчетов.

![2013-04-08_124613.png](/images/admin-guide/qreport/a3195a7d2ec7f9c5b8a6514fd501d1dc.png)

## Меню «Файл»

**Создать новый шаблон отчета —** создает новый шаблон.

**Открыть существующий шаблон отчета —** открывает шаблон.

**Закрыть —** закрывает текущий шаблон.

**Сохранить —** сохраняет текущий шаблон.

**Сохранить как… —** сохраняет текущий шаблон по другим именем.

**Печать … —** открывает окно вывода на печать текущего шаблона.

**Предварительный просмотр… —** отображает текущий шаблон в режиме просмотра.

**Предварительный просмотр фрагмента —** просмотр выбранного поля.

**Параметры печати —** открывает окно установки параметров печати.

**Экспорт —** дает возможность экспорта в MS Excel, Open Office, Open Office Writer. Open Office Calc, Internet Explorer

**Вызов Internet Explorer —** вызывает Internet Explorer и открывает в нем текущий шаблон.

**Параметры отчета —** вызывает окно параметров настройки отчета.

**Выход —** закрывает окно Генератора отчета.

## Меню «Правка»

**Отменить** — отменяет предыдущее действие.

**Повторить —** повторяет отмененное действие.

**Вырезать —** вырезает выделенный объект в буфер обмена.

**Копировать —** копирует выделенный элемент в буфер обмена.

**Копировать стили** — стиль выделенного элемента, применяет данный стиль к выбранному после нажатия элементу.

**Вставить —** вставляет данные из буфера.

**Удалить —** удаляет выделенный элемент шаблона.

**Выделить все —** выделяет все элементы шаблона.

**Ввести значение —** открывает окно Ввод выражения для выделенного элемента.

**Найти… —** вызывает строку для поиска элемента.

**Найти и заменить… —** вызывает строку для поиска и замены элемента.

## Меню «Просмотр»

**Масштаб… —** выбирает масштаб отображения шаблона.

**Выпадающий список «Показать панель инструментов»  —**включить\\выключить отображение стандартной панели инструментов.

**Стандартная —** включить\\выключить отображение панели объектов

**Цветовая палитра —** включить\\выключить отображение панели цветовая палитра.

**Форматирование —** включить\\выключить отображение панели форматирования.

## Меню «Формат»

**Подменю «Выравнивание»**

**Левые стороны —** выравнивает левые стороны объектов.

**Правые стороны —** выравнивает правые стороны объектов.

**Верхние стороны —** выравнивает верхние стороны объектов.

**Нижние стороны —** выравнивает нижние стороны объектов.

**Центры по горизонтали —** выравнивает центры объектов по горизонтали.

**Центры по вертикали —** выравнивает центры объектов по вертикали.

**Подменю «Размеры»**

**Выровнять по сетке —** выравнивает размеры выделенных объектов по сетке.

**Сделать одной ширины —** выравнивает размеры выделенных объектов по ширине.

**Сделать одной высоты —** выравнивает размеры выделенных объектов по высоте.

**Сделать одного размера —** делает размеры всех выделенных объектов одинаковыми

**Подменю «Горизонтальные расстояния»**

**Сделать равными —** делает горизонтальное расстояние между выделенными объектами равными.

**Увеличить —** увеличивает горизонтальное расстояние между выделенными объектами равными.

**Уменьшить —** уменьшает горизонтальное расстояние между выделенными объектами равными.

**Подменю Вертикальные расстояния**

**Сделать равными —** делает вертикальное расстояние между выделенными объектами равными.

**Увеличить —** увеличивает вертикальное расстояние между выделенными объектами равными.

**Уменьшить —** уменьшает вертикальное расстояние между выделенными объектами равными.

**Формат ячеек —** открывает окно настройки параметров ячейки.

## Меню «Данные»

**Выражение для группировок… —** группирует данные.

**Форматы вывода** — вывода ячеек.

**Управление секциями… —** добавляет, удаляет секции.

**Глобальные переменные… —** добавляет, удаляет переменные.

**Условия вывода ячеек… —** открывает окно ввода условий для отображения ячеек.

**Изображения… —** открывает окно добавления, удаления изображений

## Меню «Окно»

**Упорядочить все окна —** упорядочивает все окна.

# Панель инструментов

Операции можно выполнять не только через меню, а через панели инструментов: стандартная, объекты, цветовая палитра, форматирование.

Панели можно захватить за титульную строку или специальное поле мышью и перенести в любое удобное место окна Генератора отчетов:

![2013-04-08_115017.png](/images/admin-guide/qreport/bee7e759d91da3a514e78563fd175a7b.png)![2013-04-08_115123.png](/images/admin-guide/qreport/81a715a6fccf4e46bb8a1141c525f8dc.png)

## Стандартная панель инструментов

На стандартной панели инструментов располагаются кнопки стандартных операций:

![](/images/admin-guide/qreport/ec674ca16758a41fe5623fd81056472f.png)

| Кнопка                                                               | Назначение                                                                                                                                                                                           |
|----------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![2013-04-04_134044.png](/images/admin-guide/qreport/a0023cc5ddb1f401d262e59bb862c227.png) | Кнопка Новый отчет открывает новое окно                                                                                                                                                              |
| ![2013-04-08_115310.png](/images/admin-guide/qreport/1914f3fd47ca5d7043dde81f392c784c.png) | Кнопка «Открыть отчет» открывает окно с древовидным списком справочника отчетов: <br> ![2013-04-08_122051.png](/images/admin-guide/qreport/9513222d83eae3fd01569e657a5271e5.png)                                                |
| ![2013-04-08_115319.png](/images/admin-guide/qreport/8fcfedb54af569b68675856ee92557ac.png) | Кнопка «Сохранить» отчет сохраняет текущий шаблон отчета                                                                                                                                             |
| ![2013-04-08_115329.png](/images/admin-guide/qreport/b556888053dcf37732496f6c806cd09e.png) | Кнопка «Печать» открывает окно вывода на печать текущего шаблона                                                                                                                                     |
| ![2013-04-08_115402.png](/images/admin-guide/qreport/d34cf897831c425e96c171b0446f4e91.png) | Кнопка «Вырезать» вырезает выделенный объект в буфер обмена                                                                                                                                          |
| ![2013-04-08_115411.png](/images/admin-guide/qreport/abcd65535f0a965c700ad7afe96eb32d.png) | Кнопка «Копировать» копирует выделенный объект в буфер обмена.                                                                                                                                       |
| ![2013-04-08_115422.png](/images/admin-guide/qreport/734a4be561565f744f2024ea2cbab0d9.png) | Кнопка «Копировать стили» копирует стиль выделенного элемента, применяет данный стиль к выбранному после нажатия элементу                                                                            |
| ![2013-04-08_115437.png](/images/admin-guide/qreport/5f95947d9ca7048e6d6842c82f1131cc.png) | Кнопка «Вставить» вставляет данные из буфера                                                                                                                                                         |
| ![2013-04-08_115451.png](/images/admin-guide/qreport/f3e424094841c18a9b2ff283424f1351.png) | Кнопка «Удалить» удаляет выбранный элемент                                                                                                                                                           |
| ![2013-04-08_115457.png](/images/admin-guide/qreport/ba273f248a7be440a25bc16a33130c36.png) | Кнопка «Вызвать Excel» вызывает MS Excel и открывает в нем текущий шаблон                                                                                                                            |
| ![2013-04-08_115506.png](/images/admin-guide/qreport/38705745e415493abfe628097eb3542f.png) | Кнопка «Вызвать Internet Explorer» вызывает Internet Explorer и открывает в нем текущий шаблон                                                                                                       |
| ![2013-04-08_121311.png](/images/admin-guide/qreport/2319a1a91b5cd9b8107fc955992c305c.png) | Кнопка «Запустить» отчет запускает на выполнение отчета                                                                                                                                              |
| ![2013-04-08_121321.png](/images/admin-guide/qreport/770f7d0054a6bf658176c703e9333bcd.png) | Кнопка «Редактор текстов отчета» открывает окно Редактирования шаблона отчета                                                                                                                        |
| ![2013-04-08_121332.png](/images/admin-guide/qreport/49fd50ca65e301c1d32b62eed0e54b68.png) | Кнопка «Отменить» отменяет предыдущее действие                                                                                                                                                       |
| ![2013-04-08_121337.png](/images/admin-guide/qreport/5fcd28edd16c02eaf4f4af0db376edc1.png) | Кнопка «Повторить» повторяет отмененное действие                                                                                                                                                     |
| ![2013-04-08_121648.png](/images/admin-guide/qreport/32d98f68b0b41c3eb34f0971953199cd.png) | Кнопка «Показать/убрать журнал ошибок» включает/выключает отображение журнала ошибок                                                                                                                 |
| ![2013-04-08_122030.png](/images/admin-guide/qreport/921c7cd9bf5c5cf181141a76a2818c27.png) | Кнопка «Разрешить/запретить изменение отчета» включает/выключает возможность изменения элементов                                                                                                     |
| ![2013-04-08_121728.png](/images/admin-guide/qreport/854ee25a4ac78145112f5631c98ced53.png) | Изменение масштаба отображения шаблона отчета. Значение масштаба можно либо выбрать из стандартных значений (По ширине страницы, 200, 150, 125, 100, 75, 50, 25, 10), либо ввести свою величину в %. |

# Панель объектов

На панели объектов располагаются кнопки режимов работы с отчетом:

| Кнопка                                                               | Назначение |
| --- | --- |
| ![2013-04-08_122419.png](/images/admin-guide/qreport/a71bcff25477039b23cc2f9fdcda24ae.png) | Кнопка «Режим выбора объекта(ов)» включает режим работы мыши - выбор объектов                                                                                                                                                                                                                |
| ![2013-04-08_122428.png](/images/admin-guide/qreport/4776a3370bda60028808055af72f81da.png) | Кнопка «Вставка метки» позволяет вставить метку в поле отчета                                                                                                                                                                                                                                |
| ![2013-04-08_122435.png](/images/admin-guide/qreport/46c3e307bf018f207a3f66bec92f35c0.png) | Кнопка «Вставка ячейки» позволяет вставить ячейку в поле отчета                                                                                                                                                                                                                              |
| ![](/images/admin-guide/qreport/1d7d63259773fdefbc00027cbe6181d1.png)                      | Кнопка «Вставка линии» позволяет вставить линию в поле отчета                                                                                                                                                                                                                                |
| ![2013-04-08_122533.png](/images/admin-guide/qreport/c6fc47d582b19d33ac931cca7aeec35d.png) | Кнопка Вставка штрих-кода EAN13/EAN8                                                                                                                                                                                                                                                         |
| ![2013-04-08_122451.png](/images/admin-guide/qreport/0b35561eae01031e1da5234bb8c19d42.png) | Кнопка Вставка разрыва страницы позволяет вставить разрыв страницы в поле отчета                                                                                                                                                                                                             |
| ![2013-04-08_122458.png](/images/admin-guide/qreport/a2eb891b99f5663f0c6f3ea9e4fd265d.png) | По умолчанию при вставке метки (линии, ячейки, разрыва линии), режим работы автоматически переключается на режим выбора объектов. Нажатая кнопка Зафиксировать выбранный режим позволяет зафиксировать выбранный режим работы для вставки нескольких меток (линий, ячеек, разрывов страниц). |

# Панель «Цветовая палитра»

На панели цветовой палитры располагаются кнопки выбора параметров объекта, цвета которых будут изменяться, и набор цветов:

![2013-04-08_122842.png](/images/admin-guide/qreport/3940bd259d35624d39e5b600d825dd98.png)

| Кнопка                                                                                                                                    | Назначение                                                                                                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![2013-04-08_123115.png](/images/admin-guide/qreport/0f03644d800883b7f15308d531400aab.png)                                                                      | Кнопка «Изменять цвет шрифта» позволяет изменять цвет шрифта текста выбранного объекта                                                                        |
| ![2013-04-08_123121.png](/images/admin-guide/qreport/877b8c7e55241b8ecdf249869b314c63.png)                                                                      | Кнопка «Изменять цвет фона» позволяет изменить цвет фона выбранного объекта                                                                                   |
| ![2013-04-08_123131.png](/images/admin-guide/qreport/0072623df5dd0d0567cbd76f3bd00b30.png)                                                                      | Кнопка Прозрачный цвет позволяет установить прозрачный цвет фона выбранного объекта                                                                           |
| ![2013-04-08_123148.png](/images/admin-guide/qreport/d34124f3df38bda7362d67396926ef87.png)…![2013-04-08_123157.png](/images/admin-guide/qreport/21c641913d0245e1ec4c9c32aac57d26.png) | Кнопки «Цвета» позволяют установить определенный цвет для параметров объектов                                                                                 |
| ![2013-04-08_123211.png](/images/admin-guide/qreport/b63956de000fe8641249dccf0d87c92b.png)                                                                      | Кнопка «Выбрать произвольный цвет» открывает окно выбора любого цветового оттенка цвета: <br> ![2013-04-08_123230.png](/images/admin-guide/qreport/4699a019687a200a8d1c0852eb51da78.png) |

# Панель форматирования

На панели форматирования располагаются кнопки форматирования расположения элементов отчета:

![](/images/admin-guide/qreport/039150f6f3e7b2aed49e43b7d8a0348a.png)

| Кнопка                                                               | Назначение                                                                                                                                                                                        |
|----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![2013-04-08_124711.png](/images/admin-guide/qreport/1acad0f11ad1d1cdd337d704b8a9580f.png) | Кнопка «Выровнять левые края» позволяет выровнять левые края всех выбранных объектов. Выравнивание происходит по объекту, чей левый край находится левее других.                                  |
| ![2013-04-08_124720.png](/images/admin-guide/qreport/8853454bd314fa3f4c338a6d9ca8cacb.png) | Кнопка «Выровнять правые края» позволяет выровнять правые края всех выбранных объектов. Выравнивание происходит по объекту, чей правый край находится правее других.                              |
| ![2013-04-08_124734.png](/images/admin-guide/qreport/e7204bef0954b60b213673170c8a432c.png) | Кнопка «Выровнять верхние края» позволяет выровнять верхние края всех выбранных объектов. Выравнивание происходит по объекту, чей верхний край находится выше других.                             |
| ![2013-04-08_124740.png](/images/admin-guide/qreport/68db0398a52833b2de4be2144dab408c.png) | Кнопка «Выровнять нижние края» позволяет выровнять нижние края всех выбранных объектов. Выравнивание происходит по объекту, чей нижний край находится ниже других.                                |
| ![2013-04-08_124746.png](/images/admin-guide/qreport/f536c8a5a67aee1ff6f862baacd3a874.png) | Кнопка «Выровнять вертикальные центры» позволяет выровнять вертикальные центры выбранных объектов. Выравнивание происходит по объекту, который расположен на заднем плане выбранных объектов.     |
| ![2013-04-08_124753.png](/images/admin-guide/qreport/73fbf7971085db7f2a2f250836bd468a.png) | Кнопка «Выровнять горизонтальные центры» позволяет выровнять горизонтальные центры выбранных объектов. Выравнивание происходит по объекту, который расположен на заднем плане выбранных объектов. |
| ![2013-04-08_124758.png](/images/admin-guide/qreport/f74975547c6d82f9838d0c612ffaf617.png) | Кнопка «Одинаковая ширина» позволяет сделать одинаковой ширину выбранных объектов.                                                                                                                |
| ![2013-04-08_124804.png](/images/admin-guide/qreport/9b5925f5ded01475a891f4bfcb70f409.png) | Кнопка «Одинаковая высота» позволяет сделать одинаковой высоту выбранных объектов.                                                                                                                |
| ![2013-04-08_124810.png](/images/admin-guide/qreport/84fa406e3262d2d2a7ef0a8be3899df4.png) | Кнопка «Одинаковые размеры» позволяет сделать одинаковыми ширину и высоту выбранных объектов.                                                                                                     |
| ![](/images/admin-guide/qreport/cd50992ae7019b6d84582ae1c84ec089.png)                      | Кнопка «Центрировать по горизонтали» позволяет центрировать данные по горизонтали в выбранном объекте                                                                                             |
| ![](/images/admin-guide/qreport/fb6b26e253c46a5abb0d56067414c3ce.png)                      | Кнопка «Центрировать по вертикали» позволяет центрировать данные по вертикали в выбранном объекте                                                                                                 |
| ![2013-04-08_124817.png](/images/admin-guide/qreport/a92938b3b55f0d34e8646c01f2551b4f.png) | Кнопка «Переместить наверх» позволяет переместить выбранный объект на передний план, поверх остальных объектов                                                                                    |
| ![2013-04-08_124823.png](/images/admin-guide/qreport/6c93d3215113899618d6936e9db21246.png) | Кнопка «Переместить вниз» позволяет переместить выбранный объект на задний план.                                                                                                                  |

## Строка состояния

Нижнюю часть главного окна занимает строка состояния, выполняющая только информативные задачи. В частности, она отображает:

Параметры выбранного объекта:

Расположение курсора относительно отчета:

Подсказку при выборе пунктов меню:

## Просмотр и печать

Текущую форму отчета можно просмотреть в режиме предварительного просмотра. Для просмотра текущей формы отчета нужно зайти в меню **«Файл»,** выбрать пункт **«Предварительный просмотр»** либо нажать пиктограмму на панели инструментов.

![2013-04-08_125701.png](/images/admin-guide/qreport/8f32589c0141e3792ca193f9dadf361a.png)

| Кнопка                                                                | Назначение                                                   |
|-----------------------------------------------------------------------|--------------------------------------------------------------|
| ![2013-04-08_125429.png](/images/admin-guide/qreport/766dffa43d004d53c79129f975378321.png)  | Показать самый первый лист формы отчетов                     |
| ![2013-04-08_125439.png](/images/admin-guide/qreport/022bc735c7a830fd40dd3f6cc6fa1a61.png)  | Показать предыдущий лист формы отчетов                       |
| ![2013-04-08_125444.png](/images/admin-guide/qreport/ab7ecd339299ff2b6e7ac4540124b510.png)  | Показать все листы формы отчетов                             |
| ![2013-04-08_125453.png](/images/admin-guide/qreport/b1632a652897b3bbb4784a68898b91cd.png)  | Показать следующий лист формы отчетов                        |
| ![2013-04-08_125458.png](/images/admin-guide/qreport/4e6f25f97a51c4cf1ee5af96eee00f8f.png)  | Показать последний лист формы отчетов                        |
| ![2013-04-08_125503.png](/images/admin-guide/qreport/ea9b32b3ed0587d01ad10aa6a09e5d47.png)  | Выйти из режима предварительного просмотра                   |
| ![2013-04-08_125508.png](/images/admin-guide/qreport/eb3ad287337b72527dd8300c535b0ef6.png)  | Вывести на печать форму отчета                               |
| ![](/images/admin-guide/qreport/61859b37c2975a2bf6930a9515f26427.png)                       | Нажатие на клавишу мыши позволяет изменить масштаб просмотра |

# Параметры печати

Для настройки параметров печати зайти в меню **«Файл»**, выбрать пункт **«Параметры печати»**. В появившемся окне выбрать принтер, параметры бумаги для печати (размер, тип подачи бумаги на принтер, ориентация). Для подтверждения параметров необходимо нажать кнопку **«ОК**».

![2013-04-08_125848.png](/images/admin-guide/qreport/cba46c6224dafffbc6587d6489b632f8.png)

Для печати текущей формы отчета зайти в меню **«Файл»**, выбрать пункт **«Печать»** или нажать на пиктограмму на панели инструментов.

В появившемся окне выбрать диапазон печати, указать число копий, при необходимости поставить флаг «разобрать по копиям».

# Примеры корректировки отчетных форм

## Перечеркнутая цена или добавление изображения в ценнике

1.  В графическом редакторе необходимо нарисовать картинку с крестом необходимых размеров и с крестом нужного цвета. Файл сохранить в формате **\*.bmp24** или **\*.bmp32** bit.

![](/images/admin-guide/qreport/1027108343c4a3952f4326d2eec33170.png)

2.  Открыть шаблон этикетки, требующей корректировки в **«Редакторе отчетных форм»**.
3.  В меню **«Данные»** выбрать пункт **«Изображения»**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/ab5f7f8e176b2136f23422a82d2c77d2.png)

4.  В появившемся окне нажать кнопку **«Изменить рисунок»** и выбрать сохраненное изображение. Нажать кнопку **«Записать»**.

![](/images/admin-guide/qreport/e4642496d4dae2c6f2407e69e0e65161.png)

5.  Добавить ячейку в шаблон этикетки и к ее параметрам в поле **«Изображение»** выбрать ранее загруженный рисунок.

![](/images/admin-guide/qreport/054ab9ace90d6a9b43876baa007b43e0.png)

6.  Задать необходимые размеры ячейки. В меню **«Просмотр/Показать»** панели инструментов выбрать пункт **«Форматирование»**. Отобразится панель **«Форматирование»**.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/c6fddf0251df58a01362995b3c66e914.png)

7.  Выделить созданную ячейку и нажать кнопку **«Переместить вниз»**, ячейка с крестом переместится на задний план.

![](/images/admin-guide/qreport/fd52df9f1155b877777641f2bbfef6f4.png)

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/00036bf797f1b47eeae5d2ae3b2f2af6.png)

8.  В меню **«Просмотр/Показать»** панели инструментов выбрать пункт **«Цветовая палитра»**. Отобразится панель **«Цветовая палитра»**.

![Изображение выглядит как текст, стол Автоматически созданное описание](/images/admin-guide/qreport/511794803a300aa2558244f2e8cba9b2.png)

9.  Выделить ячейку с новой ценой и нажать на панели инструментов **«Цветовая палитра»** указанную кнопку **«Изменять цвет шрифта»**, затем кнопку **«Красный»**.

![](/images/admin-guide/qreport/80d4d86c237953b2ec74fb540a774e21.png)

Сохранить шаблон.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/faff4981a46a4e4ea75eda6abaaec6e6.png)

10.  Распечатать этикетки. Крест будет виден только на предварительном просмотре и при печати.

![Изображение выглядит как текст, музыка, фортепиано Автоматически созданное описание](/images/admin-guide/qreport/c025279f2200e1ae4f372605438f1566.png)

## Добавление колонок в отчет «Приходная накладная»

Добавление колонки **«Наценка»** в отчет **«Приходная накладная»**.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/5e2209486f45031c84c24f45b7563184.png)

1.  Открыть шаблон отчета на редактирование. Выделить ячейки последнего столбца и отодвинуть их вправо.
2.  Скопировать и вставить все ячейки из столбца **«Сумма»**. Передвинуть вставленные ячейки на свободное место. Передвинуть ячейки крайнего правого столбца вплотную к новым ячейкам.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/d663bcb1562c42234214b2741b76b6cf.png)

3.  Снять выделение со всех ячеек. Дважды щелкнуть по новой ячейке **«Сумма»** и в появившемся окне ввести новый заголовок колонки

![](/images/admin-guide/qreport/b06af14774bce7b175f508d345125c37.png)

4.  Дважды щелкнуть по новой ячейке, находящейся в секции **«Детальная часть»** и ввести необходимое арифметическое выражение. Выражение зависит от того, что необходимо вывести.

![](/images/admin-guide/qreport/70ae93ddc70eba859d3df90573e0fdc5.png)

Если нужно вывести наценку на единицу товара, то выражение будет следующим: **УчетнаяЦена - @Цена**

Если нужно вывести наценку на приходуемое количество товара, то выражение будет другим: **УчетнаяСумма - @Сумма**

5.  Нажать в панели инструментов кнопку **«Редактор текстов отчета»** и в скрипте входа в секцию **«Детальная часть»** добавить инициализацию переменной в которой будет считаться сумма.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/396208155fc8e41a435c27f32ef4e886.png)

6.  В тексте после вывода ячеек этой же секции произвести увеличение значения переменной. Считать итог имеет смысл только для наценки на все количество товара.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/2fb5ed4bb90b95f8b5524a3db2c49333.png)

7.  Дважды щелкнуть по новой ячейке, находящейся в **«Подвале документа»** и указать название новой переменной

![](/images/admin-guide/qreport/abf2dadd51f5efea54f7f0a68f0591ca.png)

8.  Сохранить все внесенные изменения и проверить результат, отправив приходную накладную на печать.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/688c781e981fccfdec29ba71822b22e5.png)

Аналогично можно вывести и другие необходимые данные в колонках

## Добавление колонки в отчет «Остатки ТМЦ»

Добавление колонок **«Импортер/производитель»** и **«Вид продукции»** в

отчет **«Остатки ТМЦ»**.

1.  Открыть шаблон отчета на редактирование. Отодвинуть вертикальную секцию «Верт2» вправо на ширину, необходимую для отображения двух дополнительных колонок и передвинуть ячейки правее наименования вправо.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/0a6a7fb399c40f7793d64f70f55debb7.png)

2.  Скопировать и вставить все ячейки из столбца «Наименование». Уменьшить их ширину до требуемой.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/e3fd337acd399cd64ce788a4f89fe123.png)

3.  Очистить содержимое ячеек, в которых не должно ничего отображаться и ввести правильный заголовок колонки.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/794815167189e63a39c75e92c64db133.png)

4.  Аккуратно отметить ячейку голубого цвета в новой колонке и передвинуть ее вниз. Под ней будет еще одна ячейка. Ввести в обе ячейки выражение:

![](/images/admin-guide/qreport/848dfcaf4fd4fb6dc8996f0fe12e235f.png)

```js
ЗАПРОС( "SELECT name FROM sprclient WHERE code= (SELECT importer FROM sprnn WHERE nn= '" + @Товар + "')" )
```

5.  Переместить голубую ячейку на место.
6.  Аналогичным образом выполнить действия для добавления ячейки с видом продукции. Использовать запрос:

```js
ЗАПРОС( "SELECT name FROM sprnnvid WHERE code= (SELECT nnvid FROM sprnn WHERE nn= '" + @Товар + "')" )
```

7.  Сформировать отчет и проверить результат.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/5003a0661189edd6944a8d1a0c425e52.png)

## Добавление колонки «Объем в декалитрах» в отчет «Анализ продаж»

Добавление колонки **«Объем в декалитрах»** в отчет **«Анализ продаж»**

1.  Открыть шаблон отчета на редактирование.
2.  Раздвинуть имеющиеся ячейки в нужном месте: Скопировать, вставить и уменьшить до нужного размера ячейки колонки **«Наименование»**. Ввести правильный заголовок.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/11e384cc001153c5b8970ffe80f283aa.png)

3.  В ячейке с данными ввести запрос:

```js
ЗАПРОС( "SELECT d_litr FROM sprnn WHERE nn= '" + @Товар + "'" ) * kolp / 10
```

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/qreport/44aa88cb64ba632c0e68c24e9cf8cfc6.png)

4.  Сформировать отчет и проверить результат.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/694b38d6f993a84548b9140c23a86a6f.png)

## Добавление колонки «Сумма» в «Товарный отчет»

1.  Открыть шаблон отчета на редактирование.
2.  Дважды щелкнуть на секции **«Приход»**. В появившемся окне нажать кнопку **«Скрипт входа в секцию»**.
3.  Перейти в конец текста и добавьте строку

```js
ИтогоПриходПоДокументу = 0.00;
```

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/28e3eb085e51503327c0249d2412c9de.png)

4.  В этой же секции «Скрипт после вывода ячеек» заменить на

```js
ИтогоПоПриходу += ЕСЛИ(СуммаПереоценки <> 0, СуммаПереоценки, СуммаПоУчету);

ИтогоПриходПоДокументу += ЕСЛИ( По_себестоимости == 1 and not( пусто( Категорияцены ) ), ЕСЛИ( СуммаПереоценки1 <> 0, СуммаПереоценки1, СуммаПоУчету1), СуммаПоДокументу)
```

![](/images/admin-guide/qreport/fbdb989bf3dc05eb038d41a2e360324c.png)

5.  В нужной ячейке указать текст

```js
ИтогоПриходПоДокументу
```

![](/images/admin-guide/qreport/a1303ee10753fac5c9711d4b6ed3911e.png)

6.  Указать формат вывода ячейки.

![](/images/admin-guide/qreport/2ffbdb8798c4ad8c6a1c7511c3eabc55.png)

7.  Сохранить все изменения и сформировать отчет.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/qreport/0722ff4847a2bb82ce6bd3c22ceea6d1.png)
