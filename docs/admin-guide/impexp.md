---
title: Настройка импорта и экспорта данных
description: Руководство администратора
published: true
date: 2022-08-18T14:31:02.793Z
tags: загрузка товаров, банк, импорт, экспорт, декларация, обмен с 1с, 1с
editor: markdown
dateCreated: 2022-08-03T21:20:35.808Z
---

Экспорт данных предназначен для выгрузки накопленных данных из системы Айтида в другие системы. Настройка экспорта данных позволяет организовать выгрузку произвольных данных в самых разнообразных форматах. В качестве результирующих форматов могут быть:

1.  Текстовый формат.
2.  Текстовый формат с разделителями.
3.  XML формат.
4.  DBF формат.

В окне «Справочник импорта/экспорта» можно произвести настройку экспорта.

> **Внимание!** Данная возможность доступна в режиме расширенного конфигурирования системы.


**Меню Сервис – Настройка импорта/экспорта данных**

![2013-04-16_155824.png](/images/admin-guide/impexp/56a94a03a9dabd18f2d9b25df8ab27dc.png)

Запустить выполнение шаблона экспорта из справочника **«Настройка импорта/экспорта данных»** можно нажатием правой кнопки мыши на шаблоне и выбором из контекстного меню пункта **«Выполнить»**.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/impexp/fa0b2b7bffe6e6f011b35e2860d80611.png)

В окне **«Справочник импорта/экспорта»** можно произвести настройку выгрузки данных. Поле **«Шаблон имени файла»** содержит путь для сохранения файла и его наименование.

![](/images/admin-guide/impexp/4d791febb24d59d99781415391cb7e70.png)

По умолчанию, файл находится в рабочей папке программы. Для назначения другого места хранения необходимо прописать полный путь к файлу.

**«Карточка описания экспорта данных»** открывается по двойному щелчку мыши и допускает корректировку запросов на обработку.

> **Внимание!** *Как правило, корректировка не требуется, в основном, используется функционал кнопки* **«Добавить в меню»***, чтобы вывести пункт вызова формы экспорта\\импорта для пользователей и обеспечить удобство взаимодействия с продуктом.*
{.is-success}


![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/aec755c1a6a952b0c1c1a11f3a058492.png)

**Код в системе —** код обработки импорта\\экспорта в системе Айтида, поле заполняется автоматически и недоступно для редактирования.

**Наименование —** содержится наименование карточки экспорта данных.

**Флаги «Нет», «Для документов», «Для справочника» —** определяет, в какой форме будет организован доступ к варианту экспорта данных. Если выбрано значение «Нет», то необходимо добавить в меню системы соответствующий пункт меню (кнопка «Добавить в меню»). Если выбрано значение «Для документов», то необходимо определить тип документа, в журнале которого будет организован экспорт. Если выбрано значение «Для справочника», то необходимо определить справочник, в котором будет организован экспорт.

**Выпадающий список «Формат файла» —** позволяет выбрать один из возможных форматов: «Текстовый», «Текстовый с разделителями», «XML-формат», «DBF-формат».

**Разделитель —** определяет разделитель значений, используемый в строке данных, в случае если выбран формат выгрузки файла «Текстовый с разделителями», в остальных случая поле неактивно.

**Флаг «Без заголовков полей» —** признак доступен для форматов «Текстовый» и «Текстовый с разделителями». Определяет необходимость вывода в первой строке файла с данными наименований полей данных.

**Флаг «Переводить данные» —** доступен для форматов «Текстовый», «Текстовый с разделителями» и «DBF-формат». Определяет надо ли выполнять преобразование из ANSI кодировки в OEM.

**Флаг «Заголовок и данные в одной строке» —** позволяет выгружать данные таким образом, что значение каждого поля выводится в отдельной строке и перед значением выводится заголовок поля. Например, таким образом производится выгрузка платежных поручений в банк-клиент

**Между док. —** поле доступно для формата «Текстовый с разделителями». Определяет разделитель значений, используемый для разделения строк данных, например, между документами в выгрузке ПП в банк-клиент.

**Шаблон имени файла —** в поле необходимо указать путь и шаблон имени создаваемого файла.

> ***Внимание! «Шаблон имени файла»** может содержать макро символы: **NAME** – заменится на имя шаблона, при этом пробелы будут заменены на символ ‘_’.  **N[N..N]** – заменится на следующий по порядку номер. Нумерация хранится в таблице параметров системы **param***.  **DD –** номер текущего дня месяца.  **MM –** номер текущего месяца.  **YYYY –** *номер текущего года.  **HH –** номер текущего часа.  **MI –** номер текущей минуты.  **SS –** номер текущей секунды.  Например, шаблон **D:\\NAMENNN_DDMMYYYY_HHMISS.txt**, если его указать в карточке описания экспорта **«Выгрузка в бухгалтерию»**, будет преобразован в имя файла:  **D:\\Выгрузка_в_бухгалтерию000_01102011_152134.txt.***
{.is-warning}


В списке задаются наборы данных для экспорта. Они представляют собой выражения, значениями которых должны быть SQL-запросы. Результат выполнения этих запросов будет выгружен в файл. Для каждого запроса должно быть указано имя. Это имя будет использовано в качестве имени контекста в вычислителе. Если предполагается ссылаться на это имя в последующих вычислениях, то оно должно содержать разрешенные в именах символы – буквы, цифры, символы **‘_\#@’**. В полях **«Текст до»** и **«Текст после»** можно указать выражения, значения которых будут добавлены в выгружаемый файл (кроме DBF формата) перед началом выгрузки данных текущей строки и после выгрузки всех данных текущей строки.

**Колонка «Имя запроса» —** имя запроса, с которым будет добавлен контекст в вычислитель. Если необходимо в дальнейшем ссылаться на этот контекст, то поле должно содержать только разрешенные в именах символы.

**Колонка «SQL Запрос» —** запрос, выборки данных. Выражение, значением которого должен являться SQL запрос. При вычислении выражения доступны переменные, определенные формой списка справочника, для экспорта справочника, формой журнала документов, для экспорта документов. Так же определены переменные, соответствующие параметрам шаблона экспорта данных.

**Колонка «Текст до», «Текст после» —** выражение, значение которого будет выведено в файл перед выгрузкой результата SQL запроса. Можно указать выражения, значения которых будут добавлены в выгружаемый файл (кроме DBF формата) перед началом выгрузки данных текущей строки и после выгрузки всех данных текущей строки.

**Кнопка «Настройка списка полей» —** доступна для типов файлов «Текстовый», «Текстовый с разделителями», «DBF формат».

![](/images/admin-guide/impexp/a5e1f85ae942e48dc138d986b8a9ec61.png)

**Выпадающий список «Таблица» —** выбранная таблица из списка запросов для определения порядка выгружаемых полей.

**Колонка «Имя поля» —** имя поля будет выведено в текстовый файл или будет использовано в качестве имени поля в DBF файле.

**Колонка «Выражение» —** результат вычисления будет выведен в файл.

**Колонка «Тип» —** тип, к которому будет преобразован результат вычисления выражения, перед выводом в файл. Для DBF формата – тип поля данных.

**Колонка «Размер» —** для символьного типа определяет максимальную длину поля.

**Колонка «Знаков» —** определяет количество знаков после запятой, для вещественного типа данных.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/b01a05db00547f903d608efe031a4041.png)

На вкладке **«Настройка заголовка файла»** можно определить списки строк, которые будут выведены один раз, в самом начале файла перед выгрузкой остальных данных, и в самом конце файла, после выгрузки всех данных. Эти списки имеют смысл для файлов в формате **«Текстовый»**, **«Текстовый с разделителями»** и **«XML формат»**. Так же, на этой вкладке можно определить дополнительные параметры, которые будут запрошены у пользователя перед началом выгрузки данных.

> **Примечание!** *Для формата файла* **«XML формат»** *не доступна вкладка с описанием полей. Все необходимые действия по формированию требуемого текста должны производиться в обработках* **«Текст до»** *и* **«Текст после»***. Эти обработки не обязательно должны содержать выражения, значения которых будут выведены в файл. Это могут быть произвольные обработки, формирующие данные по требуемым алгоритмам. Например, обработка, выполняющая выгрузку изображений товаров, и в конце возвращает пустую строку.* 
{.is-info}


![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/daeea3f8800489eb9fb20364ffd14303.png)

# Описание экспорта данных

В системе Айтида имеются несколько универсальных настроенных шаблонов экспорта данных, которые находятся в **«Справочнике Настройка импорта/экспорта данных»** и имеют следующие назначения:

**«Внешние заказы ФРОНТОЛ»**

В системе Айтида имеется возможность создания внешних заказов, которые в дальнейшем могут быть выгружены в кассовое ПО и при его загрузке выполняется открытие документа и автоматическая регистрация товаров.

![](/images/admin-guide/impexp/a3087600af041899e6b8549b16408b24.png)

Для выгрузки заказов необходимо создать документ **«Заказ от покупателя»** и экспортировать в кассовую программу, нажатием кнопки **«Внешние заказы ФРОНТОЛ»**.

Файл-заказ представляет собой список регистрируемых товаров, которые выгружаются в каталог, указанный в поле **«Шаблон имени файла»** в карточке экспорта данных.

**«Выгрузка алкогольной декларации»**

В системе Айтида имеется возможность строго контролировать учет алкогольной продукции для дальнейшего формирования форм, на основе которых подается декларация по алкоголю. Такой отчет по алкоголю должен содержать данные об: объемах производства, обороте и использовании этилового спирта, объемах поставок и закупок алкогольной и спиртсодержащей продукции. Организация подает документы и в целом по предприятию, и отдельно по каждому обособленных подразделений компании.

Алкогольный отчет можно сформировать из системы Айтида в электронном виде, согласно требованиям Федеральной службы по регулированию алкогольного рынка, в формате версии 4.30.08, - на основе XML. Подробнее о настройке учета и формировании отчета по алкогольной и спиртосодержащей продукции можно в разделе [Отчёт «Алкогольная декларация»](#_Отчёт_) и [Выгрузка алкогольной декларации](#выгрузка-алкогольной-декларации).

**«Выгрузка в 1C Битрикс»**

В системе Айтида имеется возможность выгружать каталог товаров в систему управления контентом интернет-сайтов, «1C Битрикс».

Сформированный файл имеет формат XML и содержит данные по товарам на складе, также выгружаются вложенные папки, цена, штриховые коды и т. п.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/902f475d59a8147bac8d5919235de751.png)

**«Выгрузка в 1C бухгалтерию»**

В системе Айтида имеется возможность выгружать данные в 1С бухгалтерию и для этих целей предусмотрено несколько шаблонов экспорта. Шаблоны имеют некоторые различия, поэтому для удобства пользователя эти различия указаны в наименовании самого шаблона экспорта. Выгрузка данных может производиться как xml-формате, так и в текстовом с разделителями. Скачать шаблоны экспорта данных также можно по [ссылке](http://itida.ru/partners/download/index.php?sid=625).

> **Внимание!** *Следует выполнить требование по загрузке параметров и констант, содержащихся в архиве для системы Айтида.*
{.is-warning}


![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/2e4f11d801772bb986d0a508fed7967a.png)

Формы ввода параметров для выгрузки данных в бухгалтерию имеют несущественные различия, после ввода параметров следует нажать кнопку **«Продолжить»**. Файл будет сформирован и сохранен по пути, указанном в шаблоне экспорта.

После чего необходимо зайти в 1С бухгалтерию и открыть обработки через главное меню **«Файл»**, которые соответствуют версии и конфигурации 1С.

> **Внимание!** *Документы при выгрузке в бухгалтерию синхронизируются по № и дате документа, если эти данные одинаковые, то документ перезаписывается*
{.is-warning}


![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/a5a764310e050fb76c0bac7a6f9f6e6e.png)

Например, для 1С:Предприятие 8.3 Бухгалтерия предприятия, редакция 3.0 (3.0.43) следует выгружать из системы Айтида шаблоном экспорта **«Выгрузка в 1C бухгалтерию редакция 3.0.30»** и использовать обработку для 1С **«ЗагрузкаДанныхXMLВБух8.3_V3.0.43.epf»**.

Подробнее о выгрузке документов в 1С можно узнать из раздела [Экспорт документов в 1С](#экспорт-в-1с).

Справочники синхронизируются по следующим полям:

1.  Справочник товаров по полю Код в главной базе.
2.  Если используется выгрузка с синхронизацией контрагентов по ИНН, то справочник контрагентов синхронизируется по ИНН. В этом случае все контрагенты должны иметь ИНН в своих карточках.
3.  Все остальные справочники синхронизируются по Доп. коду. Это значит, что код карточки в справочнике 1С должен совпадать со значением поля Доп. код карточки в справочнике Айтиды.

**«Выгрузка товаров»**

Выгрузка товаров производится в формате Айтида, данные формируются по конкретному складу в текстовом формате с разделителями и в дальнейшем могут быть использованы для загрузки в базу Айтида для заполнения справочника номенклатуры и формирования первичных приходных документов, а так же документов переоценки.

Выгружаются такие параметры товара, как: **«Код», «Артикул», «Наименование», «Единица Измерения», «Процент НДС», «Штрих-Код», «Себестоимость», «Остаток», «Цена Продажи», «Процент Наценки», «Валюта Документа»** и т.д.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/395febf159e7b57422f3ebd87372f8b9.png)

**«Клиент банка»**

Шаблон для выгрузки платежных поручений для клиент-банков. Подробнее об экспорте можно узнать в разделе [Экспорт платежных поручений](#платежные-поручения).

# Экспорт в 1С

ПП Айтида позволяет автоматически формировать бухгалтерские проводки по операциям, и предоставляет возможность выгрузки этой информации для любой внешней бухгалтерской системы.

Как правило, выгрузка производится в несколько этапов и позволяет выгружать данные в форматах: **текстовом, текстовом с разделителями, dbf-формате** и **xml-формате**.

В стандартной поставке программных продуктов справочник проводок заполнен для стандартного набора операций. Администратор системы может настроить справочник проводок под особенности ведения учета конкретного торгового предприятия.

**Меню Сервис - Настройка системы - Справочник хоз. операций**

![](/images/admin-guide/impexp/b84eb725a39ea3993475f360b7cd304f.png)

В карточке хозяйственной операции указываются шаблоны проводок, которые необходимо формировать при проведении документов. Например, проводки по документу **«Приходная накладная»**. Сформированные проводки могут быть выгружены в файл и загружены в бухгалтерскую программу.

## Экспорт хозяйственных операций

В ПП Айтида реализована выгрузка в 1С бухгалтерию.

![2013-05-17_101602.png](/images/admin-guide/impexp/f3d282daafbb05efa63c5cc556ff5f78.png)

| ![Atention4](/images/admin-guide/impexp/ecbb6d6100a6b04c1847c718353795f8.png) | **Внимание!** *По умолчанию используется экспорт* **«Выгрузка в бухгалтерию v.2».** |
|----------------------------------------------------------|-------------------------------------------------------------------------------------|

Для выгрузки данных в бухгалтерию, необходимо ввести параметры.

**Меню Сервис – Экспорт хоз. операций**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/f31d0b1929ddaa68c2113943f66a1df6.png)

**Поле «Список фирм»** — с помощью кнопки «Выбор» нужно выбрать фирму, от имени которой осуществляется выгрузка данных.

**Поля «Начало периода» и «Конец периода»** — необходимо установить начальную и конечную дату выгружаемого периода.

**Поле «Список филиалов»** — выбор филиалов

**Кнопку «Продолжить»** — после выбора фирмы и временного диапазона, можно осуществить экспорт. Успешное проведение операции экспорта сопровождается появлением окна.

![2013-04-16_160628.png](/images/admin-guide/impexp/f58be991fde3a427ed61f0c746ca3860.png)

Настроить формат выгружаемого файла можно в **«Карточке описания экспорта данных»**. Подробнее о настройке карточки описания экспорта и импорта можно узнать в разделе [Настройка импорта/экспорта данных](#_Настройка_импорта/экспорта_данных).

## Экспорт документов

> **Внимание!** *По умолчанию используется экспорт* **«Выгрузка в бухгалтерию (документами)».**
{.is-warning}

Для выгрузки данных в бухгалтерию, необходимо ввести параметры.

**Меню Сервис – Экспорт документов**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/1f2f6a9cd57e26890346ce11bf2b0b1c.png)

> **Внимание!** *При первой выгрузке данных в бухгалтерию следует указывать в параметрах выгрузки флаги* **«Выгрузить все справочники»***. Это требуется для того, чтобы в момент загрузки документов в 1С заведомо присутствовали все используемые в документах ссылки на справочники.*
{.is-warning}


> **Внимание!** *В справочниках клиентов, фирм, складов перед выгрузкой в 1С обязательно указание дополнительных кодов, для синхронизации данных с 1C.*
{.is-warning}


# Платежные поручения

Система Айтида позволяет выгружать и загружать **«Платёжное поручение».**  Это поручение плательщика обслуживающему его банку, который документом позволяет перевести определённую денежную сумму на счёт получателя средств.

Платёжные поручения принимаются банком независимо от наличия денежных средств на счёте плательщика, но исполняются только при наличии достаточных средств на нём.

Платёжное поручение составляется на бланке— форма 0401060.

## Экспорт платежных поручений

> **Внимание!** *По умолчанию используется экспорт* **«Клиент банка».**
{.is-warning}


В системе Айтида имеется универсальный настроенный экспорт платежных поручений для популярных клиент-банков, который может быть изменен администратором системы.

**Меню Сервис – Экспорт платежных поручений**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/4835e4a74c71e4136762ccc2cde5734f.png)

**Расчетный счет** — из выпадающего списка можно выбрать расчетный счет. Список р/с формируется в «Справочнике расчетных счетов».

**Период с... по** — необходимо выбрать временной диапазон.

**Номера документов с... по** — необходимо выбрать номерной диапазон.

**Клиент банка** — из выпадающего списка необходимо выбрать клиент-банк.

**Продолжить** — после выбора параметров и диапазона, можно осуществить экспорт. Успешное проведение операции экспорта сопровождается появлением окна.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/f5f01454f7c2ac72760996231f1624ef.png)

## Импорт платежных поручений

В системе Айтида имеется универсальный настроенный импорт платежных поручений для популярных клиент - банков.

**Меню Сервис – Импорт платежных поручений**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/687705b51da06e9c66bd4c8a2fb6323d.png)

**Юридическое лицо** — из выпадающего списка можно выбрать фирму.

**Выберите файл для загрузки** — необходимо выбрать файл с данными.

**Флаг «Формировать отдельно документы для прихода и расхода»** — позволит сформировать отдельно выписку по приходу и выписку по расходу денег.

После выбора параметров можно осуществить загрузку, нажатием одноименной кнопки.

# Выгрузка алкогольной декларации

В системе Айтида реализован функционал ведения учета алкогольной продукции для предпринимателей, занимающихся розничной торговлей данной продукции. Формирование отчета **«Алкогольная декларация»** производится при определенных настройках в системе для перечня ТМЦ. Подробнее о настройках в разделе [Отчёт «Алкогольная декларация»](/docs/admin-guide/reports#отчёт-алкогольная-декларация).

Алкогольная декларация — это **\*.xml** файл, в котором содержится информация о производстве и обороте спиртосодержащей продукции. Для выгрузки алкогольной декларации необходимо использовать шаблон экспорта **«Выгрузка алкогольной декларации v.2 2016 ЕГАИС формат 4.31 (производитель из накладной)»**, который можно скачать по [ссылке](http://old.itida.ru/partners/download/index.php?sid=626&id=7393).

Шаблоны подключаются в справочнике **«Настройка импорта/экспорта данных»** через кнопку **«Обмен»**. Необходимо выбрать загружаемый файл и нажать кнопку **«Загрузить»**. Так же, аналогичным образом, необходимо обновить список параметров системы (Сервис – Настройка системы - Настройка параметров системы). Файл с актуальным списком можно загрузить по [ссылке](https://itida.ru/obnovleniya-i-profili/profili-oborudovaniya-algoritmy-parametry-i-funktsii). Далее необходимо действовать согласно [инструкции](http://old.itida.ru/download/docs/2.99/ad_rules.pdf).

# Загрузка справочников

Окно «Загрузка данных» служит для загрузки информации о банках, контрагентах и товарах из внешних файлов.

> **Внимание!** *Загружать справочники банков, контрагентов и товаров надо либо одновременно, либо последовательно, сначала банки, затем контрагентов, затем товары.*
{.is-warning}


**Меню Сервис – Загрузка справочников**

![Загрузка справочников.PNG](/images/admin-guide/impexp/a1cbc3637b5a4ebf3912b3b7419686ce.png)

-   **Поля** **«Выберите** **файл для загрузки в справочник банков», «Выберите файл для загрузки в справочник контрагентов», «Выберите файл для загрузки в справочник ТМЦ»** — необходимо указать путь к файлу со справочными данными либо открыть с помощью кнопки стандартный диалог выбора файлов и указать в нём нужный файл.

> **Внимание!** *Кнопка* **«Справка по форматам файлов»** *открывает окно справки по форматам файлов* **«Описание шаблонов файлов для загрузки данных»***.*
{.is-warning}


-   **Флаги «Очистить справочник банков перед загрузкой», «Очистить справочник контрагентов перед загрузкой», «Очистить справочник ТМЦ перед загрузкой»** — установка признака укажет системе на необходимо полностью очистить соответствующий справочник перед последующей загрузкой данных. В противном случае, загружаемые данные будут дополнять справочники.
-   **Флаг «Не загружать справочник ТМЦ»** —выставить если не нужна загрузка справочника ТМЦ. В этом случае, если указано имя файла с данными для справочника ТМЦ, будут сформированы только выбранные документы.
-   **Флаги «Создавать документы по приходу», «Создавать документы по инвентаризации»** — если выставить, создаются приходные документы. При этом активизируется оставшаяся часть окна, где можно выставить флаг «Создавать документы по переоценке».
-   **Поля «Выберите склад для ввода остатков», «Выберите фирму для документов», «Дата для создания документов»** — позволяет указать значения для реквизитов создаваемых документов.
-   **Флаг «Загружать ТМЦ по артикулу» —** идентификация ТМЦ будет происходить по артикулу. В противном случае, идентификация производится по коду товара в главной базе.

# Загрузка электронных накладных

> **Внимание!** Функционал не доступен в конфигурации Малый бизнес.
{.is-warning}


Работа формы основана на обработке шаблона загрузки, в котором пользователь/партнер задает соответствие исходных полей загружаемой таблицы полям справочников и документов в системе Айтида. В форме может быть задано несколько шаблонов, настроенных для загрузки данных из разных источников.

**Меню Сервис – Загрузка электронных накладных**

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/5b0cf2f6d79ba619eb3758d0252f0cc5.png)

**Имя шаблона —** необходимо задать имя, которое будет использоваться в дальнейшем при загрузке электронной накладной из файла с определенной структурой документа. Введенное имя шаблона может быть изменено только Администратором системы.

**Введите или выберите имя файла для загрузки —** необходимо указать файл с данными. Имя файла может быть выбрано оператором в момент фактической загрузки данных. Для настройки шаблона необходимо наличие файла с данными, хотя бы тестового.

**Выберите тип документа для загрузки —** выбрать один из возможных типов документов, какие документы необходимо создать по результату загрузки данных. Если необходимо только загрузить справочники, то можно не создавать документы.

> **Внимание!** Поле **«Выберите тип документа для загрузки»** доступно для выбора оператору в момент загрузки данных.
{.is-warning}


**Флаг «Использовать правила округления в Переоценке ТМЦ» —** позволяет указать системе на необходимость округлять загружаемые цены по правилам округления, заданным в системе.

**Тип загружаемого файла —** позволяет указать, в каком формате необходимо загрузить файл (XLS (XLSX), CSV и DBF).

**Разделитель —** поле активно, в случае если тип файла загрузки выбран CSV, необходимо указать разделитель.

**Флаг «Добавлять карточки в справочники»** — необходимо установить, если в процессе загрузки данных необходимо создавать новые карточки товаров или контрагентов.

**Скрипт «Предварительная обработка загруженных данных» —** выполняется сразу после чтения данных из файла, после формирования внутренней таблицы с прочитанными данными, но перед какой–либо их обработкой. Например, в этот момент могут быть заполнены временные таблицы, для запроса у пользователя списка создаваемых товаров.

**Скрипт «Обработка данных перед сопоставлением» —** после предварительной обработки загруженных данных и создания новых карточек справочников, для обеспечения возможности пользователю указать соответствие между загружаемыми карточками товаров и существующими в системе.

**Скрипт «Пост-обработка загруженных данных» —** перед созданием документов.

> **Внимание!** Скрипты доступны в режиме **Расширенного конфигурирования**, скрипты позволяют определить дополнительные действия, которые необходимо выполнить.
{.is-warning}


**Флаг «Настройка соответствия полей» —** следует создать шаблон, если необходимо загружать данные из файлов электронных накладных, имеющих разные структуры документов. Подробнее о настройке можно узнать из раздела [Настройка соответствия полей](#настройка-соответствия-полей).

**Кнопка «Загрузить» —** нажатие кнопки осуществляет загрузку электронного документа после настройки шаблона, в окне «Загрузка документов из файлов в формате MSExcel».

В случае успешной загрузки система автоматически выдаст сообщение.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/00d6e8b84b225906c20925a0d61d01d6.png)

В базе данных будут созданы новые документы в соответствии с выбранным типом документа для загрузки, а также созданы (откорректированы) новые карточки справочников (при установке соответствующих флагов и при выполнении условий, рассмотренных выше).

## Настройка соответствия полей

Перед загрузкой данных из электронных накладных, следует создать **шаблон**. Если необходимо загружать данные из файлов электронных накладных, имеющих разные структуры документов, следует создать несколько шаблонов (свой шаблон для каждого вида электронной накладной).

Настройка шаблона представляет собой установку соответствия между полями базы данных Айтиды и колонками электронной накладной в файле.

Настройка соответствия полей осуществляется после нажатия на кнопку **«Настройка соответствия полей»**.

> **Внимание!** *Кнопка* **«Настройка соответствия полей»** *доступна Администратору системы или при запуске системы в режиме конфигурирования.*
{.is-warning}


В данном окне необходимо указать номер строки начала многострочной части в файле с данными. Это необходимо для того, чтобы система не пыталась загружать в многострочную часть документов данные шапки.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/impexp/550a6a1331aea46ad0fd3dd66e7df1e9.png)

**Номер строки для начала многострочной части —** если в электронном документе есть шапка с реквизитами, которые не требуется загружать, следует указать номер строки для начала многострочной части, заполнив одноименное поле. Для этого необходимо задать (выбрать из списка или ввести вручную) номер строки в файле, с которой начинаются данные документа. Именно эта строка является номером строки для начала многострочной части документа.

**Искать и производить автоматические замены товаров —** позволяет выбрать один из вариантов выпадающего списка: «Не производить автоматические замены» - система не будет пытаться сопоставлять загружаемые данные, с какими-либо загруженными ранее данными, и не будет предлагать пользователю сопоставлять загруженные данные с имеющимися в системе товарами. «Сопоставлять товары, но не записывать сопоставления» - система после загрузки данных предложит вручную выполнить сопоставления для товаров, которые не удалось найти в справочнике товаров. «По коду контрагента» - система будет пытаться автоматически произвести сопоставления товаров на основе ранее сделанных ручных сопоставлений, используя при этом код поставщика (контрагента). Для тех товаров, для которых не удалось автоматически найти соответствие, будут выведены для ручного сопоставления. «По наименованию шаблона» - аналогично предыдущему пункту, но поиск соответствия будет осуществляться по имени шаблона.

**Кнопка «Добавить поле»** **—** в указанной форме следует выбрать колонку, которую надо «привязать» к текущему полю шаблона.

Чтобы отобразить электронную накладную в форме **«Выбор строки и колонки из результата импорта»** необходимо нажать кнопку **«Добавить поле»**.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/impexp/18b3968d7a2e252fd423e54ea8df36aa.png)

Установить соответствие колонки или строки с полем можно, переместив курсор в колонке или в строке и нажать кнопку **«Выбрать строку и колонку»** или **«Выбрать колонку»** в зависимости от поставленной задачи. При этом, в форме «**Настройка шаблона загрузки электронных накладных»** заполняется поле **«Номер строки»**, **«Номер столбца»** и отобразится содержание ячейки.

![](/images/admin-guide/impexp/8acb20ff76d45b089c9655dcaac5a8eb.png)

**Колонка «Номер строки» —** данные из файла могут быть расположены в шапке документа или в многострочной части документа.

> **Внимание!** *Если указан номер строки, то данные будут прочитаны только один раз из указанной строки и колонки. Если номер строки не указан, то чтение данных будет производиться для всех строк, начиная с номера строки для многострочной части. В колонке* **«Поле в Айтиде»***, необходимо выбрать одно из предопределенных полей, в которое будет загружено полученное значение. Допустимые имена полей приведены в разделе* [*Описание полей для загрузки данных*](#описание-полей-для-загрузки-данных)
{.is-warning}


**Колонка «Номер столбца» —** номер столбца, в котором располагаются данные.

> **Внимание!** *Если номер столбца не указан, то должно быть указано выражение, результат вычисления которого будет присвоен соответствующему полю.*
{.is-warning}


**Колонка «Содержание ячейки» —** информационное поле, в котором отображается текущее содержимое указанной ячейки.

> **Внимание!** Если в форме **«Выбора строки и колонки из результата импорта»** при выборе ячейки в табличной части нажата кнопка **«Выбрать строку и колонку»**, то  в форме **«Настройка шаблона загрузки электронных накладных»** автоматически определяются все колонки: **«Номер строки»**, **«Номер столбца»**, **«Содержание ячейки».**
{.is-warning}


**Колонка «Поле в Айтиде» —** поле в системе Айтида, в которое будет записано значение из ячейки. Перед присвоением, будет выполнен скрипт из поля **«**Выражение». Результат вычисления будет записан в выбранное поле. Тип поля следует выбрать из списка полей в базе Айтиды.

**Колонка «Выражение» —** можно указать выражение, в котором задать алгоритм преобразования прочитанных из ячейки файла данных в данные для загрузки в поле Айтиды. Например, если в исходном файле нет отдельной ячейки, содержащей ИНН поставщика, а есть строка с его реквизитами, то в «Выражении» можно «вырезать» значение ИНН из полученной строки из файла. Перед вычислением значения выражения в вычислителе будет определена строковая переменная \_ЗНАЧЕНИЕПОЛЯ (_fieldvalue), значение которой будет равно содержимому ячейки.

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/impexp/9d3a8abaa9c14b6a223515b565ac029d.png)

> **Внимание!** *Если в таблице не указан ни номер строки, ни номер колонки с данными, то система будет обрабатывать такую настройку следующим образом.* 
{.is-warning}


1.  Будет прочитана строка данных из файла.
2.  Будут заполнены все поля с указанными номерами колонки. Если для полей указаны выражения, то они будут вычислены и результаты вычислений будут записаны в **«Поля в Айтиде»**.
3.  Для полей без указания номеров колонки, будут вычислены указанные для них **«Выражения»** и их результаты использованы в качестве значений для выбранных **«Полей в Айтиде»**.
4.  Таким образом, если не указан номер колонки с данными, то необходимо указать **«Выражение»**, для вычисления необходимого значения.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/680722ea9c001d28b4b984cb1fe23df9.png)

### Пример использования

В приведенном примере, необходимо чтобы поставщик из файла с данными был указан, как контрагент в приходной накладной, а так же как «Поставщик» в карточке создаваемого товара:

![Изображение выглядит как стол Автоматически созданное описание](/images/admin-guide/impexp/be59386fa7c2b86f37391439634bf4be.png)

Для реализации этой задачи необходимо обработать одну и ту же ячейку два раза. Для этого в первой строке необходимо сохранить значение из ячейки, а во второй использовать сохраненное значение.

## Описание полей для загрузки данных

В следующей таблице приведён список полей системы Айтида, которые доступны для использования в форме загрузки электронных накладных. В колонке **«Имя поля во временной таблице»** указано имя поля в таблице, имя которой передается пользовательским скриптам.

> **Примечание!** *Значение поля* **«Контрагент»** *в документе, определяется на основании занчений полей* **КонтрагентКод***,* **КонтрагентНаименование***,* **КонтрагентИНН***. Значение поля* **«Товар»** *определяется на основании значений полей* **ТоварКод***,* **ТоварДопКод***, ТоварАртикул, ТоварНаименование. Таким образом, поля, отвечающие за формирование справочника товаров и контрагентов, несут на себе двойное значение. Они используются для формирования карточек в справочниках и их значения используются при формировании документов.*
{.is-warning}


**ТоварКод (maincode) —** код товара в главной базе. По этому полю в первую очередь осуществляется поиск в базе данных, если поле не указано в списке, то при создании новой карточки товара будет использован следующий номер.

**ТоварДопКод (ex_code) —** дополнительный код товара. По этому полю осуществляется поиск товара, если не указан код в главной базе. Записывается в карточку товара.

**ТоварАртикул (a_code)** — артикул товара. По этому полю осуществляется поиск товара, если не указан код в главной базе и дополнительный код. Записывается в карточку товара.

**ТоварНаименование (name) —** по этому полю осуществляется поиск товара, если не указан код в главной базе, дополнительный код и артикул товара. Записывается в карточку товара. Используется как наименование в строках документов.

**ТоварКраткоеНаименование (shortname) —** по этому полю осуществляется поиск товара, если не указаны: код в главной базе, дополнительный код, артикул товара и наименование. Записывается в карточку товара. Если наименование не указано, то в документах будет использовано краткое наименование.

**ТоварЕдиницаИзмерения (ed) —** поле записывается в карточку товара, как основная единица измерения и/или в строку документа, как единица измерения.

> **Примечание!** *Если загружаемый товар уже присутствует в базе данных, и его основная единица измерения отличается от загружаемой в документ, то необходимо, чтобы была указана связь в справочнике единиц измерения между этими единицами. Иначе в документе будут возникать ошибки с пересчетом загруженной единицы измерения в основную единицу (будет использован коэффициент 1). В качестве значения может быть указан код единицы измерения, наименование или дополнительный код.*
{.is-warning}


**ТоварКодСпискаНалогов (kodn) —** поле записывается в карточку товара, в поле «Налоги» и в строку создаваемого документа в колонку «Налоги». В качестве значения должен быть указан код списка налогов из справочника списков налогов.

**ТоварПроцентНДС (procnds) —** значение поля используется для определения используемого кода списка налогов.

**ТоварСтранаПроисхождения (country) —** поле записывается в карточку товара, в поле «Страна». В качестве значения поля может быть указано название страны или код из справочника стран.

**ТоварПроизводитель (manuf) —** поле записывается в карточку товара, в поле «Производитель» (не путать с «Импортер/Производитель»). В качестве значения поля может быть указано название производителя или код из справочника производителей.

**ТоварШтрихКоды (barcode) —** штриховой код товара. Записывается в карточку товара в поле «Штриховые коды» и в серийные номера создаваемых документов. Может быть использовано для поиска товара, если другим полям поиск не дал результатов.

**ТоварПризнакПапки (folder) —** значение поля равное «1» указывает на то, что данную строку не надо использовать в документах и не надо создавать карточку товара, а надо создать папку товаров. Указанный для строки «ТоварКод» будет использован для связи товаров входящих в папку с самой папкой.

**ТоварКодРодительскойПапки (parent) —** код родительской папки, в которую необходимо поместить товар при его создании. Должен соответствовать полю «ТоварКод» ранее созданной папки. Если при загрузке файла папка не создавалась, то указанный код должен быть записан в поле «Доп. Информация» существующей папки товаров.

**ТоварВесовой (fractqty) —** признак «1» или «0» того, что является ли товар весовым. Признак записывается в карточку товара.

**ТоварМинимальноеКоличество (min_) —** значение записывается в поле Минимальный остаток карточки товара.

**ТоварКодГруппыТовара (group_) —** значение записывается в поле «Группа» карточки товаров. Может быть указан код или дополнительный код группы ресурсов. При установке группы для карточки товаров происходит заполнение следующих реквизитов из этой группы: Основная единица измерения; Дополнительные единицы измерения; Код налога; Единица измерения веса; Проценты наценки по категориям цен; Минимальный остаток; Нормы убыли.

**ТоварКодВладельцаХарактеристики (subcode) —** код в главной базе родительской карточки при загрузке характеристик товара.

**ТоварКодТипаРазреза1 (dim1_) —** код или название типа первой характеристики.Например, Цвет.

**ТоварЗначениеРазреза1 (d_code1) —** код или название значения первой характеристики. Например, Красный.

**ТоварКодТипаРазреза2 (dim2_) —** код или название типа второй характеристики.

**ТоварЗначениеРазреза2 (d_code2) —** код или название значения второй характеристики.

**ТоварКодТипаРазреза3 (dim3_) —** код или название типа третьей характеристики.

**ТоварЗначениеРазреза3 (d_code3) —** код или название значения третьей характеристики.

**ТоварКодТипаРазреза4 (dim4_) —** код или название типа четвертой характеристики.

**ТоварЗначениеРазреза4 (d_code4) —** код или название значения четвертой характеристики.

**ТоварКодТипаРазреза5 (dim5_) —** код или название типа пятой характеристики.

**ТоварЗначениеРазреза5 (d_code5) —** код или название значения пятой характеристики.

**ТоварПроцентНаценки (margin_proc) —** процент наценки. Записывается в поле «Процент наценки» карточки товара.

**ТоварПримечание (tmcnote) —** комментарий к карточке товара. Записывается в поле «Примечание» карточки товара.

**ТоварОбъем (d_litr) —** объем единицы товара. Записывается в поле «Объем» карточки товара.

**ТоварКрепость (a_proc) —** крепость алкогольного товара. Записывается в поле «Крепость» карточки товара.

**ТоварКоличествоВУпаковке (inside) —** количество в упаковке. Записывается в поле «Кол-во в упак.» карточки товара.

**ТоварВидПродукции (nnvid) —** вид алкогольной продукции. Записывается в поле «Вид продукции» карточки товара. Должен быть указан один из регламентированных кодов видов продукции.

**ТоварИмпортер (importer) —** импортер/производитель товара. Записывается в поле «Импортер/Производитель» карточки товара. Может быть указан ИНН, дополнительный код или наименование импортера/производителя.

**ТоварИмпортерКод (importer_code) —** импортер/производитель товара. Записывается в поле «Импортер/Производитель» карточки товара. Должен быть указан код импортера/производителя карточки в справочнике контрагентов. В основном поле используется в скриптах при расширенном поиске импортера/производителя товара.

**ТоварПоставщик (vendor) —** поставщик товара. Записывается в поле «Поставщик» карточки товара. Может быть указан ИНН, дополнительный код или наименование Поставщик.

**ТоварПоставщикКод (vendor_code) —** поставщик товара. Записывается в поле «Поставщик» карточки товара. Должен быть указан код поставщика в справочнике контрагентов. В основном поле используется в скриптах при расширенном поиске поставщика товара.

**ТоварВес (weight) —** вес единицы товара. Записывается в поле «Вес» карточки товара.

**ТоварЕдиницаОбъема (edd_litr) —** единица измерения объема товара. Записывается в поле «Единица объема» карточки товара. Может быть указан код единицы, название или дополнительный код.

**ТоварЕдиницаВеса (ed_weight) —** единица измерения веса товара. Записывается в поле «Единица веса» карточки товара. Может быть указан код единицы, название или дополнительный код.

**ТоварПолеДляПоиска (wareField) —** как было указано выше, стандартный поиск товара производится сначала по коду в главной базе, затем по дополнительному коду и т. д. Если необходимо производить поиск по конкретному полю, то его имя надо указать как значение для **ТоварПолеДляПоиска (wareField).**

> **Примечание!** *Часто возникают ситуации, когда необходимо, чтобы система записала в карточку все необходимые поля, но при этом идентификацию товара производила по какому-то конкретному полю, например,* **«Артикулу»***, и не искала товар по дополнительному коду или наименованию. В таких случаях необходимо в поле* **«ТоварПолеДляПоиска»** *указать имя необходимого поля. Значение должно быть взято из колонки* **«Наименование поля во временной таблице»** *этой таблицы. Например, в колонке* **«Выражение»** *для этого поля можно указать* **«a_code».**
{.is-warning}


**КонтрагентКод (clientcode) —** код карточки контрагента. По этому полю в первую очередь осуществляется поиск в базе данных. Поле не записывается в базу данных при создании новой карточки контрагента.

**КонтрагентДопКод (clientex_code) —** код карточки контрагента. По этому полю осуществляется поиск в базе данных, если не указано поле «КонтрагентКод». Записывается в поле Доп. код карточки контрагента.

**КонтрагентНаименование (clientname) —** наименование контрагента. По этому полю осуществляется поиск в базе данных, если не указано поле «КонтрагентКод» и «КонтрагентДопКод». Записывается в поле наименование карточки контрагента.

**КонтрагентИНН (clientinn) —** наименование контрагента. По этому полю осуществляется поиск в базе данных, если не указано поле «КонтрагентКод», «КонтрагентДопКод» и «КонтрагентНаименование». Записывается в поле «ИНН» карточки контрагента.

**КонтрагентШтриховойКод (clientbarcode) —** штриховой код контрагента. По этому полю осуществляется поиск в базе данных, если не указано поле «КонтрагентКод», «КонтрагентДопКод», «КонтрагентНаименование» и «КонтрагентИНН». Записывается в поле «Штриховой код карточки контрагента.

**КонтрагентКПП (clientkpp) —** КПП контрагента. Записывается в поле «КПП» карточки контрагента.

**КонтрагентОКПО (clientokpo) —** ОКПО контрагента. Записывается в поле «ОКПО» карточки контрагента.

**КонтрагентОГРН (clientogrn) —** ОГРН контрагента. Записывается в поле «ОГРН» карточки контрагента.

**КонтрагентОКАТО (clientokato) —** ОКАТО контрагента. Записывается в поле «ОКАТО» карточки контрагента.

**КонтрагентОКВЭД (clientokved) —** ОКВЭД контрагента. Записывается в поле «ОКВЭД» карточки контрагента.

**КонтрагентОКОНХ (clientokonh) —** ОКОНХ контрагента. Записывается в поле «ОКОНХ» карточки контрагента.

**КонтрагентЮрАдрес (clientaddr) —** юридический адрес контрагента. Записывается в поле «Юридический адрес» карточки контрагента.

**КонтрагентФактАдрес (clientrealaddr) —** фактический адрес контрагента. Записывается в поле «Фактический адрес» карточки контрагента.

**КонтрагентРСчет (clientrs) —** расчетный счет контрагента. Записывается в поле «Р/С» карточки контрагента.

**КонтрагентКодБанка (clientbank) —** банк, в котором находится расчетный счет контрагента. Записывается в поле «Банк» карточки контрагента.

> **Примечание!** *Может быть указан код карточки банка, дополнительный код, БИК банка или его наименование.*
{.is-warning}


**КонтрагентТелефон (clienttelefon) —** телефон контрагента. Записывается в поле «Телефон» карточки контрагента.

**КонтрагентЮрФизЛицо (clienttype) —** «Признак 1» – Юридическое лицо, «Признак 2» **—** Физическое лицо или «Признак 3» – ИЧП.

**КонтрагентПризнакПапки (clientfolder) —** значение поля равное «1» указывает на то, что данную строку не надо использовать в документах и не надо создавать карточку контрагента, а надо создать папку контрагентов. Указанный для строки КонтрагентКод будет использован для связи контрагентов, входящих в папку с самой папкой.

**КонтрагентКодРодительскойПапки (clientparent) —** код родительской папки, в которую необходимо поместить контрагента при его создании. Должен соответствовать полю «КонтрагентКод» ранее созданной папки.

**КонтрагентЛицензияНомер (l_num) —** номер лицензии контрагента. Записывается в поле «Лицензия» карточки контрагента.

**КонтрагентЛицензияДата (l_from) —** дата выдачи лицензии контрагента. Записывается в поле «Лицензия от» карточки контрагента.

**КонтрагентЛицензияСрокДействия (l_to) —** срок действия лицензии контрагента. Записывается в поле «Лицензия по» карточки контрагента.

**КонтрагентЛицензияКемВыдана (l_by) —** информация об органе выдавшем лицензию контрагенту. Записывается в поле «Выдана» карточки контрагента.

**КонтрагентПолеДляПоиска (clientField) —** как было указано выше, стандартный поиск контрагента производится сначала по коду, затем по дополнительному коду и т.д. Если необходимо производить поиск по конкретному полю, то его имя надо указать как значение для **КонтрагентПолеДляПоиска (clientField).**

> **Примечание!** *Часто возникают ситуации, когда необходимо, чтобы система записала в карточку все необходимые поля, но при этом идентификацию контрагента производила по какому-то конкретному полю, например, ИНН, и не искала контрагента по дополнительному коду или наименованию. В таких случаях необходимо в поле «КонтрагентПолеДляПоиска» указать имя необходимого поля. Значение должно быть взято из колонки «Наименование поля во временной таблице» этой таблицы. Например, в колонке «Выражение» для этого поля можно указать «cientinn».*
{.is-warning}


**БанкКод (bankcode) —** код карточки банка. По этому полю в первую очередь осуществляется поиск в базе данных. Поле не записывается в базу данных при создании новой карточки банка.

**БанкНаименование (bankname) —** наименование банка. По этому полю осуществляется поиск в базе данных, если не указано поле «БанкКод». Записывается в поле наименование карточки банка.

**БанкБИК (bankmfo) —** БИК банка. По этому полю осуществляется поиск в базе данных, если не указано поле «БанкКод» и «БанкНаименование». Записывается в поле «БИК» карточки банка.

**БанкАдрес (bankaddr) —** адрес банка. Записывается в поле «Адрес банка» карточки банка.

**БанкКорСчет (bankkors) —** кор. счет банка. Записывается в поле «Кор. счет» карточки банка.

**БанкТелефон (banktelefon) —** телефон банка. Записывается в поле «Телефон» карточки банка.

**ДокументНомер (ndok) —** номер загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументДата (date) —** дата загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументФирма (firm) —** организация загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументРС (rs) —** расчетный счет загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументВалюта (cur) —** код валюты загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументКурс (cur_rate) —** курс валюты загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументКомментарий (note) —** комментарий к документу. Записывается в поле «Комментарий» документа.

**ДокументДоговор (contract) —** код договора контрагента. Должен быть определен с использованием значения в колонке «Выражение». По этому полю осуществляется деление загруженных данных на разные документы.

**ДокументСклад (sklad) —** код склада загружаемого документа. По этому полю осуществляется деление загруженных данных на разные документы. Если не указан, то будет использован склад по умолчанию для пользователя.

**ДокументМОЛ (mol) —** код МОЛ загружаемого документа.

**ДокументСкладПолучатель (sklad_d) —** код склада получателя для загружаемых внутренних перемещений.

**ДокументМОЛПолучатель (mol_d) —** код МОЛ получателя для загружаемых внутренних перемещений.

**ДокументТип (type) —** тип приходной/расходной накладной. Допустимые значения: **для приходной накладной -** Закупка, Бонус, Комиссия, Прочее. Если не указано, то будет использовано значение «Закупка». **Для расходной накладной –** Продажа, Бонус, Комиссия, Прочее. Если не указано, то будет использовано значение «Продажа».

**ДокументСкидка (discount) —** процент скидки. Значение записывается в поле «Процент скидки».

**ДокументСчетФактура (scnum) —** номер счета фактуры поставщика. Значение записывается поле «№ счета-фактуры» приходной накладной.

**ДокументСчетФактураДата (scdate) —** дата счета фактуры поставщика. Значение записывается поле «Дата сч-фактуры» приходной накладной.

**ДокументМенеджер (manager) —** код Ответственного. Значение записывается поле «Ответственный документов».

**ДокументСтрокаКоличество (kolp) —** количество единиц товара в строке.

**ДокументСтрокаЦена (cena) —** цена единицы товара в строке.

**ДокументСтрокаЦенаРеализации (cenasale) —** цена продажи единицы товара в строке. Используется в документе «Переоценка ТМЦ».

**ДокументСтрокаСумма (summa) —** сумма по строке.

**ДокументСтрокаСуммаНДС (summands) —** сумма НДС по строке. Используется в документе «Приходная накладная» и «Возврат поставщику».

**ДокументСтрокаГТД (declar) —** номер ГТД. Используется в документе «Приходная накладная».

**ДокументСтрокаНомерСтроки (linenum) —** номер строки документа. Используется в документе «Приходная накладная».

**ДокументСтрокаСрокГодности (ex_date)** — срок годности товара. Используется в документе «Приходная накладная».

**Дополнительные поля, которые можно добавить в таблицу из справочника параметров системы (Соответствует имени параметра)** — дополнительные поля могут использоваться для обеспечения более высокой гибкости в настройках алгоритмов загрузки электронных накладных. В приведенных ниже примерах будет показано использование таких полей для создания карточек импортеров/производителей продукции.

## Пример Скриптов Настройки соответствия

В качестве примера рассмотрены скрипты «Предварительная обработка загруженных данных» и «Обработка данных перед сопоставлением». Каждый скрипт по-своему уникален и подходит для решения определенных задач.

### Пример «Обработка данных перед сопоставлением»

Данный скрипт может использоваться для выполнения нестандартных действий, которые необходимо выполнить перед созданием новых карточек товара и контрагентов. В приведенном примере будут создаваться карточки «Импортера/Производителя» в справочнике контрагентов.

![](/images/admin-guide/impexp/0b204d330a27e0eb6631df70d6f66b15.png)

Так же в этом скрипте может быть заполнена временная таблица со списком товаров, которые предварительно должен просмотреть пользователь и, возможно, удалить часть из них из загрузки.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/b27cf99cf84c74b1a9eb4385e0befb0e.png)

В этом случае, после чтения исходных данных, система Айтида выведет окно, в котором пользователь сможет снять галочки с товаров, которые не надо обрабатывать. В указанном списке могут присутствовать не все товары, а только необходимая часть. Все остальные товары пройдут стандартную обработку.

![Изображение выглядит как текст Автоматически созданное описание](/images/admin-guide/impexp/06608b17a79ada099a2a9c2d444100e8.png)

Структура временной таблицы, в которую можно поместить список товаров для выбора

| **Наименование поля**  | **Комментарии**                                                                                       |
|------------------------|-------------------------------------------------------------------------------------------------------|
| value\_                | Текстовое поле размерностью 250 символов, значение которого будет отображено в колонке Описание товар |
| f_create               | Логическое поле, соответствующее галочке в первой колонке.                                            |
| lineid                 | Целое число, соответствующее уникальному номеру загруженной строки.                                   |

Параметры, передаваемые в скрипт предварительной обработки данных

| **Наименование поля**                             | **Комментарии**                                                                  |
|---------------------------------------------------|----------------------------------------------------------------------------------|
| ИМЯТАБЛИЦЫ (LOCALTABLENAME)                       | Имя временной таблицы, в которую были прочитаны данные из загружаемого файла.    |
| ИМЯТАБЛИЦЫДЛЯВЫБОРАТОВАРОВ (SELECTWARESTABLENAME) | Имя временной таблицы, в которую можно добавить товары для выбора пользователем. |
